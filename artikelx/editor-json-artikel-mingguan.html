<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Editor JSON Artikel Mingguan (Format Array)</title>

<!-- Favicon -->
<link rel="icon" href="https://frijal.pages.dev/favicon.ico" type="image/x-icon">

<!-- Canonical -->
<link rel="canonical" href="https://frijal.pages.dev/artikel/editor-json-artikel-mingguan.html">

<!-- Meta SEO -->
<meta name="description" content="Editor JSON Artikel Mingguan dalam format array: alat praktis untuk membuat, mengedit, dan memvalidasi daftar artikel mingguan berbasis JSON langsung dari browser.">
<meta name="keywords" content="editor JSON, artikel mingguan, format array, JSON editor, web tool, data editor, Frijal Pages">
<meta name="author" content="Frijal Pages">
<meta name="robots" content="index, follow">
<meta name="language" content="id">

<!-- Open Graph / Facebook -->
<meta property="og:type" content="website">
<meta property="og:title" content="Editor JSON Artikel Mingguan (Format Array)">
<meta property="og:description" content="Alat web sederhana untuk mengelola dan mengedit daftar artikel mingguan dalam format JSON array.">
<meta property="og:url" content="https://frijal.pages.dev/artikel/editor-json-artikel-mingguan.html">
<meta property="og:site_name" content="Frijal Pages">
<meta property="og:image" content="https://frijal.pages.dev/assets/img/editor-json-artikel-mingguan.webp">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Editor JSON Artikel Mingguan (Format Array)">
<meta name="twitter:description" content="Kelola artikel mingguan berbasis JSON dengan editor praktis, langsung dari browser.">
<meta name="twitter:image" content="https://frijal.pages.dev/assets/img/editor-json-artikel-mingguan.webp">
<meta name="twitter:creator" content="@frijal">

<!-- Theme Color -->
<meta name="theme-color" content="#0ea5e9">


  <style>
    :root {
      --bg-light: #ffffff;
      --bg-dark: #121212;
      --text-light: #222;
      --text-dark: #f1f1f1;
      --accent: #2ecc71;
    }
    body {
      margin: 0;
      font-family: "Segoe UI", Roboto, sans-serif;
      background: var(--bg-light);
      color: var(--text-light);
      transition: background 0.3s, color 0.3s;
      padding: 1rem;
    }
    @media (prefers-color-scheme: dark) {
      body {
        background: var(--bg-dark);
        color: var(--text-dark);
      }
    }
    h1 { color: var(--accent); }
    .container { max-width: 1200px; margin: auto; }
    textarea {
      width: 100%;
      height: 300px;
      font-family: monospace;
      font-size: 14px;
      margin-top: 1rem;
    }
    button {
      background: var(--accent);
      color: #fff;
      border: none;
      padding: 10px 20px;
      margin: 10px 5px 0 0;
      cursor: pointer;
      border-radius: 5px;
    }
    button:hover { opacity: 0.9; }
    .output {
      margin-top: 1rem;
      padding: 1rem;
      border: 1px solid #ccc;
      border-radius: 5px;
      background: rgba(46,204,113,0.05);
      max-height: 400px;
      overflow-y: auto;
      font-size: 14px;
    }
    .download-links a {
      display: inline-block;
      margin: 5px;
      padding: 5px 10px;
      background: var(--accent);
      color: #fff;
      border-radius: 4px;
      text-decoration: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Editor JSON Artikel Mingguan (Format Array)</h1>
    <p>Unggah file <code>artikel.json</code> dengan format kategori → array artikel, lalu potong per minggu berdasarkan tanggal.</p>
    
    <input type="file" id="fileInput" accept=".json">
    <button onclick="processJSON()">Proses</button>
    
    <textarea id="jsonInput" placeholder="Atau tempel JSON di sini..."></textarea>
    
    <div class="output" id="output"></div>
    <div class="download-links" id="downloadLinks"></div>
  </div>

  <script>
    let jsonData = {};

    document.getElementById('fileInput').addEventListener('change', function(e) {
      const file = e.target.files[0];
      const reader = new FileReader();
      reader.onload = function(event) {
        document.getElementById('jsonInput').value = event.target.result;
      };
      reader.readAsText(file);
    });

    function processJSON() {
      try {
        jsonData = JSON.parse(document.getElementById('jsonInput').value);
        if (typeof jsonData !== "object") {
          alert("Format JSON harus berupa object kategori → array artikel.");
          return;
        }

        // Flatten semua artikel dari kategori
        const allArticles = [];
        Object.keys(jsonData).forEach(cat => {
          jsonData[cat].forEach(arr => {
            allArticles.push({
              judul: arr[0],
              slug: arr[1],
              gambar: arr[2],
              tanggal: arr[3],
              ringkasan: arr[4],
              kategori: cat,
              url: "https://frijal.pages.dev/artikel/" + arr[1]
            });
          });
        });

        // Group by week
        const grouped = {};
        allArticles.forEach(item => {
          const date = new Date(item.tanggal);
          if (isNaN(date)) return;
          const year = date.getFullYear();
          const week = getWeekNumber(date);
          const key = `${year}-Minggu-${week}`;
          if (!grouped[key]) grouped[key] = [];
          grouped[key].push(item);
        });

        // Render output
        let html = "";
        let links = "";
        let counter = 1;
        Object.keys(grouped).sort().forEach(week => {
          html += `<h3>${week}</h3><ul>`;
          grouped[week].forEach(a => {
            html += `<li><strong>${a.judul}</strong> [${a.kategori}] - <a href="${a.url}" target="_blank">${a.url}</a></li>`;
          });
          html += "</ul>";

          // Buat link download JSON per minggu
          const blob = new Blob([JSON.stringify(grouped[week], null, 2)], {type: "application/json"});
          const url = URL.createObjectURL(blob);
          links += `<a href="${url}" download="minggu-${counter}.json">Unduh minggu-${counter}.json</a>`;
          counter++;
        });
        document.getElementById('output').innerHTML = html;
        document.getElementById('downloadLinks').innerHTML = "<h3>Unduh Per Minggu:</h3>" + links;
      } catch (err) {
        alert("Error parsing JSON: " + err.message);
      }
    }

    function getWeekNumber(d) {
      d = new Date(Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()));
      const dayNum = d.getUTCDay() || 7;
      d.setUTCDate(d.getUTCDate() + 4 - dayNum);
      const yearStart = new Date(Date.UTC(d.getUTCFullYear(),0,1));
      return Math.ceil((((d - yearStart) / 86400000) + 1)/7);
    }
  </script>
</body>
</html>

