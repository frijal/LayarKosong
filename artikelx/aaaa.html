<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editor Artikel JSON Pro - Layar Kosong</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        :root {
            --bg-color: #121212;
            --card-bg: #1e1e1e;
            --text-color: #e0e0e0;
            --text-muted: #a0a0a0;
            --accent-color: #4caf50;
            --accent-hover: #43a047;
            --danger-color: #ef5350;
            --input-bg: #2d2d2d;
            --border-color: #333;
            --code-bg: #000000;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }

        .container { max-width: 1400px; margin: 0 auto; }

        /* CSS TAMBAHAN UNTUK INSTRUKSI */
        .instruction-box {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            margin-bottom: 30px;
            font-size: 0.95rem;
            color: var(--text-color);
        }
        .instruction-box h3 {
            margin-top: 0;
            color: var(--accent-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .instruction-box ul {
            padding-left: 20px;
        }
        .instruction-box li {
            margin-bottom: 8px;
        }
        .json-example {
            background: var(--code-bg);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #444;
            display: block;
            white-space: pre-wrap;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.85rem;
            color: #81c784; /* Warna hijau code */
            margin-top: 15px;
            overflow-x: auto;
        }
        code {
            background: #333;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
            color: #ffb74d;
        }

        /* HEADER & SEARCH */
        .app-header {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            margin-bottom: 30px;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 20px;
            z-index: 100;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }

        .app-title h1 { margin: 0; font-size: 1.5rem; display: flex; align-items: center; gap: 10px; }
        .app-title span { font-size: 0.9rem; color: var(--text-muted); font-weight: normal; }

        .search-box {
            flex: 1;
            min-width: 300px;
            position: relative;
        }

        .search-box input {
            width: 90%;
            padding: 12px 15px 12px 45px;
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: #fff;
            font-size: 1rem;
            transition: border 0.3s;
        }
        .search-box input:focus { outline: none; border-color: var(--accent-color); }
        .search-box i {
            position: absolute; left: 15px; top: 50%; transform: translateY(-50%);
            color: var(--text-muted);
        }

        .toolbar { display: flex; gap: 10px; }

        button, .btn-label {
            background-color: var(--input-bg);
            color: var(--text-color);
            border: 1px solid var(--border-color);
            padding: 10px 16px;
            cursor: pointer;
            border-radius: 6px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.2s;
            text-decoration: none;
        }

        button:hover, .btn-label:hover { background-color: #3d3d3d; border-color: #666; }

        .btn-primary { background-color: var(--accent-color); border: none; color: #fff; }
        .btn-primary:hover { background-color: var(--accent-hover); }
        .btn-danger { background-color: #c62828; border: none; color: #fff; }
        .btn-danger:hover { background-color: var(--danger-color); }

        input[type="file"] { display: none; }

        /* EDITOR AREA */
        .category-section {
            margin-bottom: 40px;
            animation: fadeIn 0.3s ease;
        }

        .cat-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }
        .cat-header h2 { margin: 0; color: var(--accent-color); font-size: 1.4rem; }
        .badge { background: #333; padding: 2px 8px; border-radius: 10px; font-size: 0.8rem; color: #aaa; }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
        }

        .card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .card:hover { transform: translateY(-4px); box-shadow: 0 5px 15px rgba(0,0,0,0.3); border-color: #555; }

        .card-img-wrapper {
            position: relative;
            width: 100%;
            height: 180px;
            background: #000;
            overflow: hidden;
        }
        .card-img { width: 100%; height: 100%; object-fit: cover; opacity: 0.9; transition: opacity 0.3s; }
        .card:hover .card-img { opacity: 1; }

        .card-body { padding: 15px; flex: 1; display: flex; flex-direction: column; }

        .card-date { font-size: 0.75rem; color: var(--text-muted); margin-bottom: 5px; display: block; }
        .card-title { font-size: 1.1rem; font-weight: 700; margin: 0 0 8px 0; line-height: 1.3; }
        .card-desc { font-size: 0.9rem; color: #ccc; margin-bottom: 15px; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; flex: 1; }
        .card-url { font-size: 0.75rem; color: var(--accent-color); margin-bottom: 15px; word-break: break-all; opacity: 0.8; font-family: monospace; }

        .card-footer {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            border-top: 1px solid var(--border-color);
        }
        .card-btn {
            background: transparent; border: none; border-radius: 0; padding: 12px 5px;
            justify-content: center; color: var(--text-muted); font-size: 0.85rem;
        }
        .card-btn:hover { background: #333; color: #fff; }
        .card-btn i { font-size: 1rem; }

        .card-btn.copy:hover { background: rgba(33, 150, 243, 0.2); color: #2196f3; }
        .card-btn.edit:hover { background: rgba(255, 255, 255, 0.1); color: #fff; }
        .card-btn.delete:hover { background: rgba(239, 83, 80, 0.2); color: var(--danger-color); }

        /* MODAL */
        .modal {
            display: none; position: fixed; z-index: 1000; left: 0; top: 0;
            width: 100%; height: 100%; background: rgba(0,0,0,0.85); backdrop-filter: blur(2px);
            justify-content: center; align-items: center;
        }
        .modal-content {
            background: var(--card-bg); width: 95%; max-width: 700px;
            padding: 30px; border-radius: 12px; border: 1px solid var(--border-color);
            max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(0,0,0,0.5);
        }

        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; color: var(--text-muted); font-size: 0.9rem; }
        .form-input {
            width: 100%; padding: 12px; background: var(--input-bg);
            border: 1px solid var(--border-color); border-radius: 6px;
            color: #fff; font-size: 1rem; box-sizing: border-box;
        }
        .form-input:focus { border-color: var(--accent-color); outline: none; }
        textarea.form-input { height: 120px; resize: vertical; }

        .preview-box {
            text-align: center; background: #000; padding: 10px;
            border-radius: 6px; margin-top: 10px; border: 1px dashed #444;
        }
        .preview-box img { max-height: 250px; max-width: 100%; border-radius: 4px; }

        #notification {
            position: fixed; bottom: 30px; right: 30px;
            background: var(--accent-color); color: white;
            padding: 15px 25px; border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transform: translateY(100px); transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 2000; font-weight: 600;
        }
        #notification.show { transform: translateY(0); }

        .empty-state { text-align: center; padding: 50px; color: var(--text-muted); }
        .highlight { background-color: rgba(76, 175, 80, 0.3); color: #fff; padding: 0 2px; border-radius: 2px; }

        @media(max-width: 768px) {
            .app-header { flex-direction: column; align-items: stretch; position: static; }
            .form-row { grid-template-columns: 1fr; gap: 0; }
        }
    </style>
</head>
<body>
<div class="container">
    <header class="app-header">
        <div class="app-title">
            <h1><i class="fa-solid fa-layer-group"></i> Layar Kosong <span>Editor</span></h1>
        </div>

        <div class="search-box">
            <i class="fa-solid fa-magnifying-glass"></i>
            <input type="text" id="searchInput" placeholder="Cari judul, url, deskripsi, atau gambar..." oninput="handleSearch()">
        </div>

        <div class="toolbar">
            <label for="fileInput" class="btn-label">
                <i class="fa-solid fa-folder-open"></i> Buka JSON
            </label>
            <input type="file" id="fileInput" accept=".json">

            <button onclick="downloadJSON()" class="btn-primary">
                <i class="fa-solid fa-save"></i> Simpan
            </button>
            <button onclick="addCategory()">
                <i class="fa-solid fa-plus"></i> Kategori
            </button>
        </div>
    </header>

    <section class="instruction-box">
        <h3><i class="fa-solid fa-circle-info"></i> Panduan Penggunaan Editor</h3>
        <p>Editor ini dirancang untuk mengelola database artikel berbasis file <code>.json</code> secara offline/online. Anda bisa menambah, mengubah, atau menghapus entri artikel dengan antarmuka visual yang modern.</p>

        <ul>
            <li><strong>Import:</strong> Gunakan tombol <code>Buka JSON</code> untuk memuat file artikel Anda.</li>
            <li><strong>Struktur:</strong> Script ini mengelola JSON dengan format <strong>Object of Arrays</strong>, di mana tiap key adalah nama kategori, dan isinya adalah array yang menampung data artikel.</li>
            <li><strong>Data Artikel:</strong> Setiap artikel diwakili oleh array flat dengan urutan: <code>[Judul, Nama File, Link Gambar, ISO Timestamp, Deskripsi]</code>.</li>
            <li><strong>Export:</strong> Setelah selesai mengedit, tekan tombol <code>Simpan</code> untuk mengunduh file JSON terbaru.</li>
        </ul>

        <p><strong>Contoh Format JSON yang bisa diubah dan dihasilkan oleh halaman ini:</strong></p>
        <code class="json-example">{
  "üñ•Ô∏è Teknologi": [
    [
      "Judul Artikel",
      "slug-artikel.html",
      "https://link-gambar.com/foto.webp",
      "2025-12-20T10:00:00+00:00",
      "Ringkasan deskripsi artikel yang akan tampil di halaman depan."
    ]
  ]
}</code>
    </section>

    <div id="mainContent">
        <div class="empty-state">
            <i class="fa-solid fa-file-code" style="font-size: 4rem; margin-bottom: 20px; opacity: 0.5;"></i>
            <h3>Belum ada data</h3>
            <p>Silakan buka file <code>artikel.json</code> untuk memulai.</p>
        </div>
    </div>
</div>

<div id="modalEditor" class="modal">
    <div class="modal-content">
        <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
            <h2 id="modalTitle" style="margin:0;">Edit Artikel</h2>
            <button onclick="closeModal()" style="background:none; border:none; font-size:1.5rem;">&times;</button>
        </div>

        <form id="editForm" onsubmit="saveArticle(event)">
            <input type="hidden" id="editCat">
            <input type="hidden" id="editIdx">

            <div class="form-group">
                <label>Judul Artikel</label>
                <input type="text" id="inpTitle" class="form-input" required placeholder="Contoh: Tutorial Linux Pemula">
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>URL / Slug (HTML)</label>
                    <input type="text" id="inpUrl" class="form-input" required placeholder="tutorial-linux.html">
                </div>
                <div class="form-group">
                    <label>Tanggal (Waktu Setempat)</label>
                    <input type="datetime-local" id="inpDate" class="form-input" required>
                </div>
            </div>

            <div class="form-group">
                <label>URL Gambar Thumbnail</label>
                <input type="text" id="inpImg" class="form-input" required placeholder="https://..." oninput="updatePreview()">
                <div class="preview-box">
                    <img id="imgPreview" src="" onerror="this.style.display='none'" onload="this.style.display='inline-block'">
                    <p id="imgError" style="font-size:0.8rem; color:#f44336; display:none; margin-top:5px;">Gambar tidak ditemukan</p>
                </div>
            </div>

            <div class="form-group">
                <label>Deskripsi Singkat</label>
                <textarea id="inpDesc" class="form-input" required placeholder="Ringkasan isi artikel..."></textarea>
            </div>

            <div style="text-align: right; margin-top: 30px;">
                <button type="button" onclick="closeModal()" style="margin-right: 10px;">Batal</button>
                <button type="submit" class="btn-primary"><i class="fa-solid fa-check"></i> Simpan Perubahan</button>
            </div>
        </form>
    </div>
</div>

<div id="notification">Pesan Notifikasi</div>

<script>
    let globalData = {};
    let isSearchMode = false;

    // 1. Load File
    document.getElementById('fileInput').addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = (e) => {
            try {
                globalData = JSON.parse(e.target.result);
                document.getElementById('searchInput').value = '';
                isSearchMode = false;
                renderUI(globalData);
                showNotif("‚úÖ Database berhasil dimuat!");
            } catch (err) {
                alert("File JSON rusak atau format salah.");
            }
        };
        reader.readAsText(file);
    });

    // 2. Render UI
    function renderUI(dataToRender, highlightQuery = "") {
        const container = document.getElementById('mainContent');
        container.innerHTML = '';

        if (Object.keys(dataToRender).length === 0) {
            container.innerHTML = `<div class="empty-state"><h3>Tidak ditemukan hasil</h3></div>`;
            return;
        }

        const sortedCats = Object.keys(dataToRender).sort();

        sortedCats.forEach(cat => {
            const articles = dataToRender[cat];
            if (articles.length === 0) return;

            const section = document.createElement('div');
            section.className = 'category-section';

            section.innerHTML = `
                <div class="cat-header">
                    <h2>${highlightText(cat, highlightQuery)} <span class="badge">${articles.length}</span></h2>
                    <div style="margin-left:auto; display:flex; gap:5px;">
                        <button onclick="addArticle('${cat}')" class="btn-primary" style="padding:6px 12px; font-size:0.8rem;">
                            <i class="fa-solid fa-plus"></i> Artikel
                        </button>
                        <button onclick="renameCategory('${cat}')" style="padding:6px 12px; font-size:0.8rem;">
                            <i class="fa-solid fa-pen"></i>
                        </button>
                        <button onclick="deleteCategory('${cat}')" class="btn-danger" style="padding:6px 12px; font-size:0.8rem;">
                            <i class="fa-solid fa-trash"></i>
                        </button>
                    </div>
                </div>
            `;

            const grid = document.createElement('div');
            grid.className = 'grid';

            articles.forEach((item) => {
                let artData, realIndex;

                if (isSearchMode) {
                    artData = item.data;
                    realIndex = item.originalIndex;
                } else {
                    artData = item;
                    realIndex = globalData[cat].indexOf(item);
                }

                const [title, url, img, dateStr, desc] = artData;
                const displayDate = new Date(dateStr).toLocaleDateString('id-ID', { day: 'numeric', month: 'short', year: 'numeric' });

                const safeUrl = url.replace(/'/g, "\\'");

                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <div class="card-img-wrapper">
                        <img src="${img}" class="card-img" onerror="this.src='https://via.placeholder.com/400x200?text=No+Image'">
                    </div>
                    <div class="card-body">
                        <span class="card-date"><i class="fa-regular fa-clock"></i> ${displayDate}</span>
                        <div class="card-title">${highlightText(title, highlightQuery)}</div>
                        <div class="card-url" title="${url}">${highlightText(url, highlightQuery)}</div>
                        <div class="card-desc">${highlightText(desc, highlightQuery)}</div>
                    </div>
                    <div class="card-footer">
                       <button class="card-btn edit" onclick="openEditor('${cat}', ${realIndex})">
                            <i class="fa-solid fa-pen-to-square"></i> Edit
                        </button>
                        <button class="card-btn delete" onclick="deleteArticle('${cat}', ${realIndex})">
                            <i class="fa-solid fa-trash-can"></i> Hapus
                        </button>
                         <button class="card-btn copy" onclick="copyToClipboard('${safeUrl}')" title="Salin Nama File">
                            <i class="fa-regular fa-copy"></i> Salin
                        </button>
                    </div>
                `;
                grid.appendChild(card);
            });

            section.appendChild(grid);
            container.appendChild(section);
        });
    }

    function copyToClipboard(text) {
        navigator.clipboard.writeText(text).then(() => {
            showNotif("üìã Disalin: " + text);
        }).catch(err => {
            showNotif("‚ùå Gagal menyalin.");
        });
    }

    function handleSearch() {
        const query = document.getElementById('searchInput').value.toLowerCase();
        if (!query) {
            isSearchMode = false;
            renderUI(globalData);
            return;
        }
        isSearchMode = true;
        const filteredData = {};
        for (const [cat, articles] of Object.entries(globalData)) {
            const matches = articles.map((art, index) => {
                const fullText = (art[0] + " " + art[1] + " " + art[2] + " " + art[4]).toLowerCase();
                if (fullText.includes(query)) return { data: art, originalIndex: index };
                return null;
            }).filter(item => item !== null);
            if (matches.length > 0) filteredData[cat] = matches;
        }
        renderUI(filteredData, query);
    }

    function highlightText(text, query) {
        if (!query || !text) return text;
        const regex = new RegExp(`(${query})`, 'gi');
        return text.toString().replace(regex, '<span class="highlight">$1</span>');
    }

    function openEditor(category, index) {
        document.getElementById('modalEditor').style.display = 'flex';
        document.getElementById('editCat').value = category;
        document.getElementById('editIdx').value = index;
        const art = globalData[category][index];
        document.getElementById('modalTitle').innerText = (index === -1) ? "Tambah Artikel Baru" : "Edit Artikel";
        if (index !== -1) {
            document.getElementById('inpTitle').value = art[0];
            document.getElementById('inpUrl').value = art[1];
            document.getElementById('inpImg').value = art[2];
            try {
                const d = new Date(art[3]);
                d.setMinutes(d.getMinutes() - d.getTimezoneOffset());
                document.getElementById('inpDate').value = d.toISOString().slice(0, 16);
            } catch (e) { document.getElementById('inpDate').value = ''; }
            document.getElementById('inpDesc').value = art[4];
        } else {
            document.getElementById('editForm').reset();
            const now = new Date();
            now.setMinutes(now.getMinutes() - now.getTimezoneOffset());
            document.getElementById('inpDate').value = now.toISOString().slice(0, 16);
        }
        updatePreview();
    }

    function addArticle(category) { openEditor(category, -1); }

    function saveArticle(e) {
        e.preventDefault();
        const cat = document.getElementById('editCat').value;
        const idx = parseInt(document.getElementById('editIdx').value);
        const title = document.getElementById('inpTitle').value;
        const url = document.getElementById('inpUrl').value;
        const img = document.getElementById('inpImg').value;
        const desc = document.getElementById('inpDesc').value;
        const dateRaw = document.getElementById('inpDate').value;
        const dateObj = new Date(dateRaw);
        const isoDate = dateObj.toISOString().replace('.000Z', '+00:00');
        const newRecord = [title, url, img, isoDate, desc];

        if (idx === -1) globalData[cat].unshift(newRecord);
        else globalData[cat][idx] = newRecord;

        closeModal();
        if (isSearchMode) handleSearch();
        else renderUI(globalData);
        showNotif("Data Berhasil Disimpan!");
    }

    function deleteArticle(category, index) {
        if (confirm("Yakin ingin menghapus artikel?")) {
            globalData[category].splice(index, 1);
            if (isSearchMode) handleSearch();
            else renderUI(globalData);
            showNotif("Artikel dihapus.");
        }
    }

    function addCategory() {
        const name = prompt("Nama Kategori Baru:");
        if (name) {
            if (globalData[name]) { alert("Kategori sudah ada!"); return; }
            globalData = { [name]: [], ...globalData };
            renderUI(globalData);
        }
    }

    function deleteCategory(cat) {
        if (confirm(`Hapus kategori "${cat}"?`)) {
            delete globalData[cat];
            renderUI(globalData);
        }
    }

    function renameCategory(oldName) {
        const newName = prompt("Nama Baru:", oldName);
        if (newName && newName !== oldName) {
            const newData = {};
            Object.keys(globalData).forEach(key => {
                if (key === oldName) newData[newName] = globalData[key];
                else newData[key] = globalData[key];
            });
            globalData = newData;
            renderUI(globalData);
        }
    }

    function updatePreview() {
        const url = document.getElementById('inpImg').value;
        const img = document.getElementById('imgPreview');
        const err = document.getElementById('imgError');
        if (url) {
            img.src = url;
            img.style.display = 'inline-block';
            img.onerror = () => { img.style.display='none'; err.style.display='block'; };
            img.onload = () => { err.style.display='none'; };
        } else {
            img.style.display = 'none';
            err.style.display = 'none';
        }
    }

    function closeModal() { document.getElementById('modalEditor').style.display = 'none'; }

    function showNotif(msg) {
        const n = document.getElementById('notification');
        n.innerText = msg;
        n.classList.add('show');
        setTimeout(() => n.classList.remove('show'), 3000);
    }

    function downloadJSON() {
        if (Object.keys(globalData).length === 0) return;
        const str = JSON.stringify(globalData, null, 2);
        const blob = new Blob([str], {type: "application/json"});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = "artikel_updated.json";
        a.click();
    }

    window.onclick = function(event) {
        if (event.target === document.getElementById('modalEditor')) closeModal();
    }
</script>
</body>
</html>
