<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Pemisah JSON Artikel Mingguan (Offline) - frijal.pages.dev</title>
    <meta name="description" content="Alat offline untuk memisahkan data artikel dari file JSON besar (via upload atau paste) menjadi file JSON per minggu (Senin-Minggu) dengan format nama file YYYY-minggu-WW.json.">
    
    <link rel="canonical" href="https://frijal.pages.dev/tools/pemisah-json-mingguan-offline.html"> <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>✂️</text></svg>">
    
    <meta property="og:title" content="Pemisah JSON Artikel Mingguan (Offline)">
    <meta property="og:description" content="Alat web offline untuk membagi JSON artikel besar per minggu via upload atau paste (nama file: YYYY-minggu-WW.json).">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://frijal.pages.dev/tools/pemisah-json-mingguan-offline.html"> <meta property="og:image" content="https://placehold.co/1200x630/28a745/ffffff?text=JSON+Splitter+Offline">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="frijal.pages.dev">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Pemisah JSON Artikel Mingguan (Offline)">
    <meta name="twitter:description" content="Alat web offline untuk membagi JSON artikel besar per minggu via upload atau paste (nama file: YYYY-minggu-WW.json).">
    <meta name="twitter:image" content="https://placehold.co/1200x630/28a745/ffffff?text=JSON+Splitter+Offline">
    <style>
        /* --- Variabel Warna (Dark/Light Mode Otomatis) --- */
        :root {
            --bg-color: #f8f9fa;
            --text-color: #212529;
            --header-color: #000;
            --card-bg: #ffffff;
            --border-color: #dee2e6;
            --accent-color: #0056b3;
            --link-color: #007bff;
            --link-hover: #004085;
            --code-bg: #e9ecef;
            --button-bg: #007bff;
            --button-text: #ffffff;
            --button-hover-bg: #0056b3;
            --textarea-bg: #ffffff;
            --textarea-border: #ced4da;
            --input-file-bg: #e9ecef;
            --input-file-border: #ced4da;
            --input-file-text: #495057;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg-color: #121212;
                --text-color: #e0e0e0;
                --header-color: #ffffff;
                --card-bg: #1e1e1e;
                --border-color: #333;
                --accent-color: #00aaff;
                --link-color: #00aaff;
                --link-hover: #1aaaff;
                --code-bg: #2a2a2a;
                --button-bg: #00aaff;
                --button-text: #121212;
                --button-hover-bg: #0088cc;
                 --textarea-bg: #2a2a2a;
                --textarea-border: #444;
                --input-file-bg: #343a40;
                --input-file-border: #444;
                --input-file-text: #adb5bd;
            }
        }

        /* --- Global & Desain Fullscreen --- */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html, body {
            min-height: 100vh;
            width: 100%;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.7;
            font-size: 17px;
            transition: background-color 0.3s, color 0.3s;
        }

        /* --- Desain Widescreen & Responsif --- */
        main {
            max-width: 900px; /* Layout widescreen */
            margin: 2rem auto;
            padding: 1rem 2rem;
        }

        h1 {
            font-size: 2.4rem;
            color: var(--header-color);
            text-align: center;
            margin-bottom: 1.5rem;
        }

        p {
            margin-bottom: 1.2rem;
        }
        
        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
        }
        
        /* Styling untuk input file */
        input[type="file"] {
            display: block;
            width: 100%;
            padding: 0.75rem 1rem;
            margin-bottom: 1rem;
            font-size: 1rem;
            color: var(--input-file-text);
            background-color: var(--input-file-bg);
            border: 1px solid var(--input-file-border);
            border-radius: 8px;
            cursor: pointer;
        }
        
         input[type="file"]::file-selector-button {
            padding: 0.5rem 1rem;
            margin-right: 1rem;
            border: none;
            border-radius: 4px;
            background-color: var(--button-bg);
            color: var(--button-text);
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        input[type="file"]::file-selector-button:hover {
            background-color: var(--button-hover-bg);
        }

        textarea {
            width: 100%;
            min-height: 200px; 
            padding: 1rem;
            font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
            font-size: 0.9em;
            border: 1px solid var(--textarea-border);
            border-radius: 8px;
            background-color: var(--textarea-bg);
            color: var(--text-color);
            margin-bottom: 1rem;
            resize: vertical;
        }

        button {
            display: block;
            width: 100%;
            padding: 1rem 1.5rem;
            font-size: 1.1rem;
            font-weight: bold;
            color: var(--button-text);
            background-color: var(--button-bg);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
            margin-bottom: 2rem;
        }

        button:hover {
            background-color: var(--button-hover-bg);
        }

        #outputLinks h2 {
            margin-bottom: 1rem;
             font-size: 1.5rem;
             color: var(--header-color);
        }

        #outputLinks ul {
            list-style: none;
            padding: 0;
        }

        #outputLinks li {
             background-color: var(--card-bg);
             border: 1px solid var(--border-color);
             border-radius: 8px;
             margin-bottom: 0.75rem;
        }
        
        #outputLinks a {
            display: block;
            padding: 0.8rem 1.2rem;
            text-decoration: none;
            color: var(--link-color);
            font-weight: 500;
        }
        
        #outputLinks a:hover {
             color: var(--link-hover);
             background-color: var(--code-bg);
             border-radius: 8px;
        }
        
        .status-message, .error-message {
            color: var(--text-color); 
            background-color: var(--code-bg);
            border: 1px solid var(--border-color);
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
            margin-bottom: 1rem;
        }
        
        .error-message {
            color: #dc3545; /* Bootstrap danger color */
            background-color: rgba(220, 53, 69, 0.1);
            border: 1px solid rgba(220, 53, 69, 0.2);
        }

        /* --- Footer --- */
        footer {
            text-align: center;
            padding: 2rem 1rem;
            font-size: 0.9em;
            color: #888;
            border-top: 1px solid var(--border-color);
            margin-top: 3rem;
        }
        
        footer a {
            color: var(--accent-color);
            text-decoration: none;
        }

        /* --- Mobile-Friendly (Responsif) --- */
        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }
            main {
                margin: 1rem auto;
                padding: 0 1rem;
            }
            textarea {
                min-height: 150px;
                font-size: 0.85em;
            }
            button {
                font-size: 1rem;
                padding: 0.8rem 1.2rem;
            }
            input[type="file"] {
                font-size: 0.9rem;
                padding: 0.6rem 0.8rem;
            }
        }
    </style>
<meta property="og:image:alt" content="Pemisah JSON Artikel Mingguan (Offline) - frijal.pages.dev">
  <meta itemprop="image" content="https://frijal.pages.dev/img/pemisah-json-mingguan-offline.webp">
<link rel="stylesheet" href="/ext/marquee-url.css"><link rel="alternate" type="application/rss+xml" title="30 artikel baru bikin." href="https://frijal.pages.dev/rss.xml" />
</head>
<body>

    <main>
        <h1>✂️ Pemisah JSON Artikel Mingguan (Offline)</h1>
<div id="iposbrowser"></div>
        <p>Pilih file <code>file.json</code> Anda atau tempelkan kontennya di bawah ini, lalu klik tombol untuk memisahkannya menjadi file-file JSON per minggu (Senin-Minggu) dengan format nama <strong>YYYY-minggu-WW.json</strong>.</p>
        
        <label for="jsonFile">Pilih File JSON:</label>
        <input type="file" id="jsonFile" accept=".json">

        <label for="jsonInput">Atau Paste Konten JSON di Sini:</label>
        <textarea id="jsonInput" placeholder="Paste konten file.json di sini jika tidak memilih file..."></textarea>

        <button id="processButton">Proses & Buat File JSON Mingguan</button>

        <div id="outputLinks">
            </div>
    </main>
    
    <footer>
        <p>&copy; 2025 <a href="https://frijal.pages.dev">frijal.pages.dev</a> | Dibuat dengan cinta dan secangkir kopi.</p>
    </footer>

    <script>
        document.getElementById('processButton').addEventListener('click', handleProcess);

        function handleProcess() {
            const fileInput = document.getElementById('jsonFile');
            const textArea = document.getElementById('jsonInput');
            const outputDiv = document.getElementById('outputLinks');
            outputDiv.innerHTML = '<p class="status-message">Memproses...</p>'; // Status awal

            // Prioritize file input
            if (fileInput.files.length > 0) {
                const file = fileInput.files[0];
                const reader = new FileReader();

                reader.onload = function(event) {
                    const fileContent = event.target.result;
                    processJson(fileContent); // Process the file content
                };

                reader.onerror = function(event) {
                     outputDiv.innerHTML = '<p class="error-message">Error membaca file!</p>';
                     console.error("File reading error:", event);
                };

                reader.readAsText(file); // Read the file as text
            } else {
                // Fallback to textarea if no file is selected
                const jsonInput = textArea.value;
                if (!jsonInput.trim()) {
                     outputDiv.innerHTML = '<p class="error-message">Tidak ada file dipilih dan input teks kosong!</p>';
                     return;
                }
                processJson(jsonInput); // Process the textarea content
            }
        }

        // Helper function to get Monday of the week for a given date
        function getMonday(d) {
            d = new Date(d);
            const day = d.getDay(); // 0 = Sunday, 1 = Monday, ..., 6 = Saturday
            const diff = d.getDate() - day + (day === 0 ? -6 : 1); // Adjust when Sunday
            return new Date(d.setDate(diff));
        }

        // Helper function to format date as YYYY-MM-DD
        function formatDateYYYYMMDD(date) {
            const year = date.getFullYear();
            const month = (date.getMonth() + 1).toString().padStart(2, '0');
            const day = date.getDate().toString().padStart(2, '0');
            return `${year}-${month}-${day}`;
        }
        
        // Helper to get ISO week number (Standard algorithm)
        function getIsoWeek(date) {
            const tempDate = new Date(date.getTime());
            tempDate.setHours(0, 0, 0, 0);
            // Thursday in current week decides the year.
            tempDate.setDate(tempDate.getDate() + 3 - (tempDate.getDay() + 6) % 7);
            // January 4 is always in week 1.
            const week1 = new Date(tempDate.getFullYear(), 0, 4);
            // Adjust to Thursday in week 1 and count number of weeks from date to week1.
            return 1 + Math.round(((tempDate.getTime() - week1.getTime()) / 86400000
                                - 3 + (week1.getDay() + 6) % 7) / 7);
        }

        // Core processing function (now takes jsonString as argument)
        function processJson(jsonString) { 
            const outputDiv = document.getElementById('outputLinks');
            outputDiv.innerHTML = ''; // Clear processing message

            let jsonData;
            try {
                jsonData = JSON.parse(jsonString);
            } catch (error) {
                outputDiv.innerHTML = `<p class="error-message">Error parsing JSON: ${error.message}</p>`;
                return;
            }

            const weeklyData = {};
            let articleCount = 0;
            const baseUrl = "https://frijal.pages.dev/artikel/"; // Base URL for articles

            // 1. Iterate through categories and articles, group by week (using Monday's date)
            for (const category in jsonData) {
                if (jsonData.hasOwnProperty(category)) {
                    const articlesInCategory = jsonData[category];
                    if (Array.isArray(articlesInCategory)) {
                        articlesInCategory.forEach(articleArr => {
                            if (Array.isArray(articleArr) && articleArr.length >= 4) {
                                const [title, slug, image, dateStr, summary] = articleArr;
                                
                                // Basic validation for essential fields
                                if (!title || !slug || !dateStr) {
                                    console.warn("Skipping article with missing title, slug, or date:", articleArr);
                                    return; // Skip this article
                                }

                                const articleDate = new Date(dateStr);
                                if (isNaN(articleDate.getTime())) {
                                     console.warn("Skipping article with invalid date:", dateStr, articleArr);
                                     return; // Skip invalid date
                                }

                                const mondayDate = getMonday(articleDate);
                                const mondayKey = formatDateYYYYMMDD(mondayDate);

                                if (!weeklyData[mondayKey]) {
                                    weeklyData[mondayKey] = [];
                                }

                                // Construct the output object
                                const articleOutput = {
                                    judul: title,
                                    slug: slug,
                                    gambar: image || '', // Handle potentially missing image
                                    tanggal: dateStr,
                                    ringkasan: summary || '', // Handle potentially missing summary
                                    kategori: category,
                                    url: baseUrl + slug
                                };

                                weeklyData[mondayKey].push(articleOutput);
                                articleCount++;
                            } else {
                                 console.warn("Skipping invalid article array format:", articleArr);
                            }
                        });
                    }
                }
            }
            
            if (articleCount === 0) {
                 outputDiv.innerHTML = '<p class="error-message">Tidak ada artikel valid yang ditemukan dalam JSON.</p>';
                 return;
            }

            // 2. Sort weeks chronologically
            const sortedWeeks = Object.keys(weeklyData).sort();

            // 3. Generate download links for each week
            const outputList = document.createElement('ul');
            outputDiv.innerHTML = `<h2>File JSON Mingguan (Total ${articleCount} artikel):</h2>`;
            
            sortedWeeks.forEach((mondayKey) => {
                const weekArticles = weeklyData[mondayKey];
                
                // Sort articles within the week by date (ascending)
                 weekArticles.sort((a, b) => new Date(a.tanggal) - new Date(b.tanggal));

                // --- Updated Week Numbering Logic with Year ---
                const currentWeekDate = new Date(mondayKey); 
                const currentWeekNumber = getIsoWeek(currentWeekDate);
                const currentYear = currentWeekDate.getFullYear(); // Get the year
                // Pad week number with leading zero if needed
                const paddedWeekNumber = currentWeekNumber.toString().padStart(2, '0'); 
                const fileName = `${currentYear}-minggu-${paddedWeekNumber}.json`; // YYYY-minggu-WW.json
                // --- End Updated Logic ---
                
                const jsonStringOutput = JSON.stringify(weekArticles, null, 2); // Pretty print
                const blob = new Blob([jsonStringOutput], { type: 'application/json' });
                const url = URL.createObjectURL(blob);

                const listItem = document.createElement('li');
                const link = document.createElement('a');
                link.href = url;
                link.download = fileName;
                // Update link text content to show the new filename format
                link.textContent = `Unduh ${fileName} (Minggu ke-${currentWeekNumber} ${currentYear}, mulai ${mondayKey}, ${weekArticles.length} artikel)`;
                
                listItem.appendChild(link);
                outputList.appendChild(listItem);
            });
            
            outputDiv.appendChild(outputList);
        }
    </script>

<div class="search-floating-container"><input type="text" id="floatingSearchInput" placeholder="cari artikel..." autocomplete="off"><span id="floatingSearchClear" class="clear-button"></span><div id="floatingSearchResults" class="floating-results-container"></div></div>
<section id="related-marquee-section"><div id="related-marquee-container"></div></section><script defer src="/ext/marquee-url.js"></script>
<script defer src="/ext/iposbrowser.js"></script><script defer src="/ext/markdown.js"></script>
</body>
</html>
