<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Batch Editor article:published_time</title>

    <meta name="description" content="Cara praktis melakukan batch edit meta tag article:published_time untuk optimasi SEO dan manajemen konten yang lebih efisien di blog Anda.">
    <meta name="author" content="Fakhrul Rijal">
    <link rel="canonical" href="https://dalam.web.id/artikel/published-time-artikel-editor.html">
    <meta name="robots" content="index, follow">

    <meta property="og:site_name" content="Layar Kosong">
    <meta property="og:title" content="Batch Editor article:published_time: Kelola Waktu Publikasi dengan Cepat">
    <meta property="og:description" content="Optimalkan alur kerja blogging Anda dengan Batch Editor untuk meta tag waktu publikasi. Lebih rapi, lebih SEO-friendly!">
    <meta property="og:url" content="https://dalam.web.id/artikel/published-time-artikel-editor.html">
    <meta property="og:type" content="article">
    <meta property="og:image" content="https://dalam.web.id/thumbnail.webp">
    <meta property="og:image:alt" content="Ilustrasi Batch Editor article:published_time di Layar Kosong">
    <meta property="og:locale" content="id_ID">

    <meta property="article:published_time" content="2025-12-23T15:39:00+08:00"> <meta property="article:modified_time" content="2025-12-23T15:39:00+08:00">
    <meta property="article:section" content="Teknologi">
    <meta property="article:tag" content="SEO">
    <meta property="article:tag" content="Web Development">
    <meta property="article:tag" content="Tutorial">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@frijal">
    <meta name="twitter:creator" content="@frijal">
    <meta name="twitter:title" content="Batch Editor article:published_time">
    <meta name="twitter:description" content="Cara praktis edit massal meta tag published_time untuk efisiensi konten blog.">
    <meta name="twitter:image" content="https://dalam.web.id/thumbnail.webp">

    <link rel="icon" href="/favicon.ico">

    <style>
body{
  font-family:system-ui,-apple-system,sans-serif;
  max-width:960px;
  margin:40px auto;
  padding:0 16px;
}
label{font-weight:600;display:block;margin-top:16px}
input,button{padding:8px 12px;margin-top:6px}
button.primary{background:#2563eb;color:#fff;border:none}
button.warn{background:#b91c1c;color:#fff;border:none}
pre{
  background:#111;
  color:#22c55e;
  padding:12px;
  max-height:260px;
  overflow:auto;
}
.diff{
  background:#0f172a;
  color:#e5e7eb;
  padding:12px;
  margin-top:12px;
  border-left:4px solid #2563eb;
}
.diff del{color:#ef4444}
.diff ins{color:#22c55e;text-decoration:none}
small{color:#555}
</style>
<meta name="google-adsense-account" content="ca-pub-8157928740123992"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8157928740123992" crossorigin="anonymous"></script><meta itemprop="image" content="https://dalam.web.id/img/published-time-artikel-editor.webp">
<link rel="stylesheet" href="/ext/marquee-url.css"><link rel="alternate" type="application/rss+xml" title="30 artikel baru bikin." href="https://dalam.web.id/rss.xml" />
</head>

<body>

<h1>Paranoid ISO Year–Month Editor</h1>
<div id="iposbrowser"></div>
<small>
✔ Cari literal <code>"YYYY-MM-DDT</code><br>
✔ Ubah <strong>tahun & bulan saja</strong><br>
✔ Mode paranoid: banyak kombinasi → tetap dipaksa seragam<br>
✔ Meta dibuat otomatis jika tidak ada
</small>

<label>Tahun Baru (YYYY)</label>
<input id="yearInput" placeholder="2026">

<label>Bulan Baru (MM)</label>
<input id="monthInput" placeholder="03">

<div style="margin-top:12px">
  <button id="pickFolder">Pilih Folder HTML</button>
  <button id="pickList">Pilih ubahtanggal.txt</button>
  <button id="preview" class="primary">Preview</button>
  <button id="apply" class="warn">Terapkan</button>
</div>

<input id="folderFallback" type="file" webkitdirectory multiple hidden>
<input id="listFallback" type="file" accept=".txt" hidden>

<hr>

<h3>Preview Diff</h3>
<div id="diffBox"></div>

<h3>Log</h3>
<pre id="log"></pre>


<script>
let folderHandle=null;
let listHandle=null;
let listFile=null;
let fallbackFiles=[];
let allowedFiles=new Set();
let changes=[];

const logBox=document.getElementById("log");
const diffBox=document.getElementById("diffBox");
const log=m=>logBox.textContent+=m+"\n";

/* STRICT + PARANOID */
const ISO_REGEX = /"(\d{4})-(\d{2})-(\d{2}T)/g;

/* waktu lokal sistem */
function systemISO(Y,M){
  const d=new Date();
  const pad=n=>String(n).padStart(2,"0");
  const tz=-d.getTimezoneOffset();
  const sign=tz>=0?"+":"-";
  const hh=pad(Math.floor(Math.abs(tz)/60));
  const mm=pad(Math.abs(tz)%60);
  return `"${Y}-${M}-${pad(d.getDate())}T${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}${sign}${hh}:${mm}"`;
}

/* PICKERS */
pickFolder.onclick=async()=>{
  if(window.showDirectoryPicker){
    try{
      folderHandle=await showDirectoryPicker();
      fallbackFiles=[];
      log("✔ Folder dipilih");
      return;
    }catch{}
  }
  folderFallback.click();
};
folderFallback.onchange=e=>{
  fallbackFiles=[...e.target.files];
  folderHandle=null;
  log(`✔ Folder fallback (${fallbackFiles.length})`);
};

pickList.onclick=async()=>{
  if(window.showOpenFilePicker){
    try{
      [listHandle]=await showOpenFilePicker({types:[{accept:{"text/plain":[".txt"]}}]});
      listFile=null;
      log("✔ ubahtanggal.txt dipilih");
      return;
    }catch{}
  }
  listFallback.click();
};
listFallback.onchange=e=>{
  listFile=e.target.files[0];
  listHandle=null;
  log("✔ ubahtanggal.txt dipilih (fallback)");
};

/* PREVIEW */
preview.onclick=async()=>{
  diffBox.innerHTML="";
  logBox.textContent="";
  changes=[];
  allowedFiles.clear();

  const Y=yearInput.value.trim();
  const M=monthInput.value.trim();

  if(!/^\d{4}$/.test(Y)||!/^\d{2}$/.test(M)||+M<1||+M>12){
    alert("Tahun / bulan tidak valid");
    return;
  }

  if((!folderHandle&&!fallbackFiles.length)||(!listHandle&&!listFile)){
    alert("Folder dan ubahtanggal.txt wajib dipilih");
    return;
  }

  const txt=listHandle
    ? await (await listHandle.getFile()).text()
    : await listFile.text();

  txt.split(/\r?\n/).map(v=>v.trim()).filter(Boolean)
     .forEach(f=>allowedFiles.add(f));

  for(const name of allowedFiles){
    try{
      let html,file;
      if(folderHandle){
        const fh=await folderHandle.getFileHandle(name);
        file=await fh.getFile();
        html=await file.text();
      }else{
        file=fallbackFiles.find(f=>f.name===name);
        if(!file){log(`⚠ Tidak ada: ${name}`);continue;}
        html=await file.text();
      }

      const matches=[...html.matchAll(ISO_REGEX)];

      let newHtml=html;
      if(matches.length){
        const combos=new Set(matches.map(m=>`${m[1]}-${m[2]}`));
        if(combos.size>1){
          log(`⚠ ${name}: ${combos.size} kombinasi → dipaksa seragam`);
        }
        newHtml=html.replace(ISO_REGEX,`"${Y}-${M}-$3`);
      }else{
        log(`➕ ${name}: meta tidak ada → disuntik`);
        newHtml=html.replace(
          /<\/head>/i,
          `  <meta property="article:published_time" content=${systemISO(Y,M)}>\n</head>`
        );
      }

      changes.push({name,html:newHtml});

      diffBox.innerHTML+=`
<div class="diff">
<strong>${name}</strong><br>
<ins>→ Tahun-Bulan diseragamkan ke ${Y}-${M}</ins>
</div>`;
    }catch{
      log(`✖ Gagal proses: ${name}`);
    }
  }

  log(`Preview selesai (${changes.length} file)`);
};

/* APPLY */
apply.onclick=async()=>{
  if(!changes.length){alert("Tidak ada perubahan");return;}
  if(!confirm("Terapkan perubahan (mode paranoid)?")) return;

  for(const f of changes){
    try{
      if(folderHandle){
        const fh=await folderHandle.getFileHandle(f.name);
        const w=await fh.createWritable();
        await w.write(f.html);
        await w.close();
        log(`✔ Updated ${f.name}`);
      }else{
        const a=document.createElement("a");
        a.href=URL.createObjectURL(new Blob([f.html],{type:"text/html"}));
        a.download=f.name;
        a.click();
        log(`⬇ Download ${f.name}`);
      }
    }catch{
      log(`✖ Gagal tulis ${f.name}`);
    }
  }
};
</script>

<div class="search-floating-container"><input type="text" id="floatingSearchInput" placeholder="cari artikel..." autocomplete="off"><span id="floatingSearchClear" class="clear-button"></span><div id="floatingSearchResults" class="floating-results-container"></div></div>
<section id="related-marquee-section"><div id="related-marquee-container"></div></section><script defer src="/ext/marquee-url.js"></script>
<script defer src="/ext/iposbrowser.js"></script><script defer src="/ext/markdown.js"></script><script defer src="/ext/pesbukdiskus.js"></script>
</body>
</html>
