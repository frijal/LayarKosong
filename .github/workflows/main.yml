name: Renovate Fast
on:
  schedule:
    # Jalan tiap jam, bisa diubah sesuai kebutuhan
    - cron: '0 * * * *'
  workflow_dispatch: # Bisa jalan manual juga

jobs:
  renovate:
    runs-on: ubuntu-latest
    container:
      image: ghcr.io/renovatebot/renovate:full
      # Mount cache agar Renovate bisa simpan metadata dependency
      volumes:
        - renovate-cache:/tmp/renovate/cache
    steps:
      - name: Checkout repo
        uses: actions/checkout@v6
        with:
          fetch-depth: 1

      - name: Run Renovate
        run: |
          echo "Starting Renovate..."
          renovate --config-file mini/renovate.json5
        env:
          # Token untuk akses repo
          RENOVATE_TOKEN: ${{ secrets.RENOVATE_TOKEN }}
          # Aktifkan cache repository
          RENOVATE_REPOSITORY_CACHE: enabled

# Define Docker volume inline
volumes:
  renovate-cache:
