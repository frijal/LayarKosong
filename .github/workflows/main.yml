name: Renovate Fast
on:
  schedule:
    # Jalan tiap jam, bisa diubah sesuai kebutuhan
    - cron: '0 * * * *'
  workflow_dispatch: # Bisa jalan manual juga

jobs:
  renovate:
    runs-on: ubuntu-latest
    container:
      image: ghcr.io/renovatebot/renovate:full
      # Jalankan container sebagai root agar checkout bisa tulis di workspace
      options: --user root
      # Mount folder 'sementara/' sebagai cache
      volumes:
        - ${{ github.workspace }}/sementara:/tmp/renovate/cache
    steps:
      - name: Checkout repo
        uses: actions/checkout@v6
        with:
          fetch-depth: 1  # hemat waktu

      - name: Run Renovate
        run: |
          echo "Starting Renovate..."
          renovate --config-file mini/renovate.json5
        env:
          # Token GH_PAT untuk akses repo & update workflow
          RENOVATE_TOKEN: ${{ secrets.GH_PAT }}
          # Aktifkan cache repository
          RENOVATE_REPOSITORY_CACHE: enabled
