{
  "id": "pengecekan-laporan-konten-harian",
  "slug": "pengecekan-laporan-konten-harian",
  "title": "Pengecekan & Laporan Konten Harian ‚Äî GitHub Actions üîÜ",
  "category": "üîÜ Lainnya",
  "published_at": "2025-10-22T11:53:56.642+00:00",
  "url": "https://dalam.web.id/artikel/pengecekan-laporan-konten-harian.html",
  "image": "https://dalam.web.id/img/pengecekan-laporan-konten-harian.webp",
  "content": {
    "text": "üîÜ Pengecekan & Laporan Konten Harian Workflow otomatis untuk menjaga kebersihan folder dan memantau jumlah konten harian di GitHub Pages. Workflow ini dibuat supaya repo tetap rapi dan laporan konten selalu up to date. Ia berjalan otomatis setiap hari jam 21:00 UTC (atau sekitar jam 04:00 WIB) dan juga bisa dijalankan manual lewat tombol di GitHub Actions. üéØ Tujuan Workflow üßπ Membersihkan file gambar orphan (.webp) yang tidak memiliki artikel HTML pasangannya. üßæ Menghitung jumlah artikel, cover, dan total file dalam folder artikel & img. üìä Membuat laporan harian dalam bentuk file teks & badge JSON. üß© Job 1: Cleanup Gambar Orphan Job pertama akan memindai semua file .webp di folder img/. Jika tidak ditemukan file HTML dengan nama yang sama di folder artikel/, maka file gambar tersebut dianggap yatim dan akan dihapus menggunakan perintah git rm. for webp_file in img/*.webp; do base_name=$(basename \"$webp_file\" .webp) html_file=\"artikel/${base_name}.html\" if [ ! -f \"$html_file\" ]; then git rm -f \"$webp_file\" fi done üìä Job 2: Laporan & Badge Setelah pembersihan, workflow akan menghitung file berdasarkan ekstensi (html, webp, png), membuat file laporan, serta membuat tiga badge: artikel Jumlah file HTML cover Jumlah file WebP html/webp Perbandingan total keduanya üìú Contoh Laporan Harian LAPORAN KONTEN: artikel & img (10-22) ================================= Total File: 104 HTML=53, webp=48, PNG=3 Ringkasan per ekstensi: 53 html 48 webp 3 png URL File HTML (dari folder 'artikel'): https://dalam.web.id/artikel/nama-artikel.html ... ‚öôÔ∏è Kode Workflow Lengkap Berikut adalah isi file workflow .github/workflows/laporan-konten.yml yang siap digunakan: name: üîÜ Pengecekan & Laporan Konten Harian on: schedule: - cron: '0 21 * * *' workflow_dispatch: jobs: cleanup: runs-on: ubuntu-latest permissions: contents: write steps: - name: Checkout repository uses: actions/checkout@v4 with: fetch-depth: 0 - name: Cari dan Hapus Gambar Orphan id: cleanup_step run: | echo \"üßπ Memulai proses pembersihan gambar orphan...\" DELETED_COUNT=0 mkdir -p img shopt -s nullglob for webp_file in img/*.webp; do base_name=$(basename \"$webp_file\" .webp) html_file=\"artikel/${base_name}.html\" if [ ! -f \"$html_file\" ]; then echo \"-> Orphan: '$webp_file' tidak memiliki artikel. Menghapus...\" git rm -f \"$webp_file\" DELETED_COUNT=$((DELETED_COUNT + 1)) fi done shopt -u nullglob echo \"deleted_count=$DELETED_COUNT\" >> $GITHUB_OUTPUT - name: Commit & Push Hasil Pembersihan (jika ada) if: steps.cleanup_step.outputs.deleted_count != '0' run: | git config user.name \"github-actions[bot]\" git config user.email \"github-actions[bot]@users.noreply.github.com\" git commit -m \"chore(cleanup): Hapus ${{ steps.cleanup_step.outputs.deleted_count }} gambar orphan .webp\" git pull origin main --rebase git push - name: No Orphan Found if: steps.cleanup_step.outputs.deleted_count == '0' run: echo \"‚úÖ Tidak ada gambar orphan ditemukan.\" reporting: needs: cleanup runs-on: ubuntu-latest permissions: contents: write steps: - name: Checkout repository uses: actions/checkout@v4 - name: Setup Variables id: vars run: | TARGETS=\"artikel img\" DATE=$(date +'%m-%d') REPORT=\"mini/${DATE}-laporan_konten.txt\" echo \"report_path=$REPORT\" >> $GITHUB_OUTPUT echo \"targets=$TARGETS\" >> $GITHUB_OUTPUT echo \"date=$DATE\" >> $GITHUB_OUTPUT - name: Count Files by Extension id: counts run: | TARGETS=\"${{ steps.vars.outputs.targets }}\" declare -A counts for ext in html webp png; do counts[$ext]=$(find $TARGETS -maxdepth 1 -type f -iname \"*.$ext\" | wc -l) done counts[all]=$(find $TARGETS -maxdepth 1 -type f | wc -l) for key in \"${!counts[@]}\"; do echo \"$key=${counts[$key]}\" >> $GITHUB_OUTPUT done - name: Generate Report run: | REPORT=\"${{ steps.vars.outputs.report_path }}\" DATE=\"${{ steps.vars.outputs.date }}\" TARGETS=\"${{ steps.vars.outputs.targets }}\" PREFIX_ARTIKEL=\"https://dalam.web.id/artikel/\" mkdir -p \"$(dirname \"$REPORT\")\" { echo \"LAPORAN KONTEN: artikel & img ($DATE)\" echo \"=================================\" echo \"Total File: ${{ steps.counts.outputs.all }}\" echo \"HTML=${{ steps.counts.outputs.html }}, webp=${{ steps.counts.outputs.webp }}, PNG=${{ steps.counts.outputs.png }}\" echo \"\" echo \"Ringkasan per ekstensi:\" find $TARGETS -maxdepth 1 -type f -print | sed 's/.*\\.//' | sort | uniq -c | sort -nr echo \"\" echo \"URL File HTML:\" find artikel -maxdepth 1 -type f -iname \"*.html\" | sed \"s|^artikel/|$PREFIX_ARTIKEL|g\" | sort } > \"$REPORT\" cat \"$REPORT\" - name: Install jq run: sudo apt-get update && sudo apt-get install -y jq - name: Buat Badge JSON run: | mkdir -p mini html=${{ steps.counts.outputs.html }} webp=${{ steps.counts.outputs.webp }} color=$(if (( html > webp )); then echo red; elif (( html < webp )); then echo green; else echo blue; fi) jq -n --arg m \"$html\" '{schemaVersion:1,label:\"artikel\",message:$m,color:\"blue\"}' > mini/html_count_badge.json jq -n --arg m \"$webp\" '{schemaVersion:1,label:\"cover\",message:$m,color:\"green\"}' > mini/webp_count_badge.json jq -n --arg mh \"$html\" --arg mj \"$webp\" --arg c \"$color\" '{schemaVersion:1,label:\"html/webp\",message:(\"\\($mh) / \\($mj)\"),color:$c}' > mini/html_webp_badge.json - name: Rotate Reports run: | mkdir -p mini mapfile -t files < <(ls -1t mini/*-laporan_*.txt 2>/dev/null) if ((${#files[@]} > 7)); then printf '%s\\n' \"${files[@]:7}\" | xargs rm -f fi - name: Commit, Pull, and Push Changes run: | git config --global user.name 'github-actions[bot]' git config --global user.email '41898282+github-actions[bot]@users.noreply.github.com' git add mini/* if ! git diff --staged --quiet; then git commit -m \"chore: update laporan & badge konten\" --author=\"frijal <5477182+frijal@users.noreply.github.com>\" git pull origin main --rebase git push else echo \"‚úÖ Tidak ada perubahan baru untuk di-commit.\" fi",
    "html": "<header>\n    <h1>üîÜ Pengecekan &amp; Laporan Konten Harian</h1>\n\n    <p>Workflow otomatis untuk menjaga kebersihan folder dan memantau jumlah konten harian di GitHub Pages.</p>\n  </header>\n  <main>\n    <p>Workflow ini dibuat supaya <strong>repo tetap rapi</strong> dan <strong>laporan konten selalu up to date</strong>. Ia berjalan otomatis setiap hari jam 21:00 UTC (atau sekitar jam 04:00 WIB) dan juga bisa dijalankan manual lewat tombol di GitHub Actions.</p>\n    <h2>üéØ Tujuan Workflow</h2>\n    <ul>\n      <li>üßπ Membersihkan file gambar <em>orphan</em> (.webp) yang tidak memiliki artikel HTML pasangannya.</li>\n      <li>üßæ Menghitung jumlah artikel, cover, dan total file dalam folder <code>artikel</code> &amp; <code>img</code>.</li>\n      <li>üìä Membuat laporan harian dalam bentuk file teks &amp; badge JSON.</li>\n    </ul>\n    <h2>üß© Job 1: Cleanup Gambar Orphan</h2>\n    <div class=\"highlight\">\n      Job pertama akan memindai semua file <code>.webp</code> di folder <code>img/</code>. Jika tidak ditemukan file HTML dengan nama yang sama di folder <code>artikel/</code>, maka file gambar tersebut dianggap yatim dan akan dihapus menggunakan perintah <code>git rm</code>.\n    </div>\n    <pre><code>for webp_file in img/*.webp; do\n  base_name=$(basename \"$webp_file\" .webp)\n  html_file=\"artikel/${base_name}.html\"\n  if [ ! -f \"$html_file\" ]; then\n    git rm -f \"$webp_file\"\n  fi\ndone</code></pre>\n    <h2>üìä Job 2: Laporan &amp; Badge</h2>\n    <p>Setelah pembersihan, workflow akan menghitung file berdasarkan ekstensi (<code>html</code>, <code>webp</code>, <code>png</code>), membuat file laporan, serta membuat tiga badge:</p>\n    <ul>\n      <li><span class=\"badge\">artikel</span> Jumlah file HTML</li>\n      <li><span class=\"badge\">cover</span> Jumlah file WebP</li>\n      <li><span class=\"badge\">html/webp</span> Perbandingan total keduanya</li>\n    </ul>\n    <h2>üìú Contoh Laporan Harian</h2>\n    <pre><code>LAPORAN KONTEN: artikel &amp; img (10-22)\n=================================\nTotal File: 104\nHTML=53, webp=48, PNG=3\nRingkasan per ekstensi:\n     53 html\n     48 webp\n      3 png\nURL File HTML (dari folder 'artikel'):\nhttps://dalam.web.id/artikel/nama-artikel.html\n...</code></pre>\n    <h2>‚öôÔ∏è Kode Workflow Lengkap</h2>\n    <p>Berikut adalah isi file workflow <code>.github/workflows/laporan-konten.yml</code> yang siap digunakan:</p>\n    <pre><code>name: üîÜ Pengecekan &amp; Laporan Konten Harian\non:\n  schedule:\n    - cron: '0 21 * * *'\n  workflow_dispatch:\njobs:\n  cleanup:\n    runs-on: ubuntu-latest\n    permissions:\n      contents: write\n    steps:\n      - name: Checkout repository\n        uses: actions/checkout@v4\n        with:\n          fetch-depth: 0\n      - name: Cari dan Hapus Gambar Orphan\n        id: cleanup_step\n        run: |\n          echo \"üßπ Memulai proses pembersihan gambar orphan...\"\n          DELETED_COUNT=0\n          mkdir -p img\n          shopt -s nullglob\n          for webp_file in img/*.webp; do\n            base_name=$(basename \"$webp_file\" .webp)\n            html_file=\"artikel/${base_name}.html\"\n            if [ ! -f \"$html_file\" ]; then\n              echo \"-&gt; Orphan: '$webp_file' tidak memiliki artikel. Menghapus...\"\n              git rm -f \"$webp_file\"\n              DELETED_COUNT=$((DELETED_COUNT + 1))\n            fi\n          done\n          shopt -u nullglob\n          echo \"deleted_count=$DELETED_COUNT\" &gt;&gt; $GITHUB_OUTPUT\n      - name: Commit &amp; Push Hasil Pembersihan (jika ada)\n        if: steps.cleanup_step.outputs.deleted_count != '0'\n        run: |\n          git config user.name \"github-actions[bot]\"\n          git config user.email \"github-actions[bot]@users.noreply.github.com\"\n          git commit -m \"chore(cleanup): Hapus ${{ steps.cleanup_step.outputs.deleted_count }} gambar orphan .webp\"\n          git pull origin main --rebase\n          git push\n      - name: No Orphan Found\n        if: steps.cleanup_step.outputs.deleted_count == '0'\n        run: echo \"‚úÖ Tidak ada gambar orphan ditemukan.\"\n  reporting:\n    needs: cleanup\n    runs-on: ubuntu-latest\n    permissions:\n      contents: write\n    steps:\n      - name: Checkout repository\n        uses: actions/checkout@v4\n      - name: Setup Variables\n        id: vars\n        run: |\n          TARGETS=\"artikel img\"\n          DATE=$(date +'%m-%d')\n          REPORT=\"mini/${DATE}-laporan_konten.txt\"\n          echo \"report_path=$REPORT\" &gt;&gt; $GITHUB_OUTPUT\n          echo \"targets=$TARGETS\" &gt;&gt; $GITHUB_OUTPUT\n          echo \"date=$DATE\" &gt;&gt; $GITHUB_OUTPUT\n      - name: Count Files by Extension\n        id: counts\n        run: |\n          TARGETS=\"${{ steps.vars.outputs.targets }}\"\n          declare -A counts\n          for ext in html webp png; do\n            counts[$ext]=$(find $TARGETS -maxdepth 1 -type f -iname \"*.$ext\" | wc -l)\n          done\n          counts[all]=$(find $TARGETS -maxdepth 1 -type f | wc -l)\n          for key in \"${!counts[@]}\"; do\n            echo \"$key=${counts[$key]}\" &gt;&gt; $GITHUB_OUTPUT\n          done\n      - name: Generate Report\n        run: |\n          REPORT=\"${{ steps.vars.outputs.report_path }}\"\n          DATE=\"${{ steps.vars.outputs.date }}\"\n          TARGETS=\"${{ steps.vars.outputs.targets }}\"\n          PREFIX_ARTIKEL=\"https://dalam.web.id/artikel/\"\n          mkdir -p \"$(dirname \"$REPORT\")\"\n          {\n            echo \"LAPORAN KONTEN: artikel &amp; img ($DATE)\"\n            echo \"=================================\"\n            echo \"Total File: ${{ steps.counts.outputs.all }}\"\n            echo \"HTML=${{ steps.counts.outputs.html }}, webp=${{ steps.counts.outputs.webp }}, PNG=${{ steps.counts.outputs.png }}\"\n            echo \"\"\n            echo \"Ringkasan per ekstensi:\"\n            find $TARGETS -maxdepth 1 -type f -print | sed 's/.*\\.//' | sort | uniq -c | sort -nr\n            echo \"\"\n            echo \"URL File HTML:\"\n            find artikel -maxdepth 1 -type f -iname \"*.html\" | sed \"s|^artikel/|$PREFIX_ARTIKEL|g\" | sort\n          } &gt; \"$REPORT\"\n          cat \"$REPORT\"\n      - name: Install jq\n        run: sudo apt-get update &amp;&amp; sudo apt-get install -y jq\n      - name: Buat Badge JSON\n        run: |\n          mkdir -p mini\n          html=${{ steps.counts.outputs.html }}\n          webp=${{ steps.counts.outputs.webp }}\n          color=$(if (( html &gt; webp )); then echo red; elif (( html &lt; webp )); then echo green; else echo blue; fi)\n          jq -n --arg m \"$html\" '{schemaVersion:1,label:\"artikel\",message:$m,color:\"blue\"}' &gt; mini/html_count_badge.json\n          jq -n --arg m \"$webp\" '{schemaVersion:1,label:\"cover\",message:$m,color:\"green\"}' &gt; mini/webp_count_badge.json\n          jq -n --arg mh \"$html\" --arg mj \"$webp\" --arg c \"$color\" '{schemaVersion:1,label:\"html/webp\",message:(\"\\($mh) / \\($mj)\"),color:$c}' &gt; mini/html_webp_badge.json\n      - name: Rotate Reports\n        run: |\n          mkdir -p mini\n          mapfile -t files &lt; &lt;(ls -1t mini/*-laporan_*.txt 2&gt;/dev/null)\n          if ((${#files[@]} &gt; 7)); then\n            printf '%s\\n' \"${files[@]:7}\" | xargs rm -f\n          fi\n      - name: Commit, Pull, and Push Changes\n        run: |\n          git config --global user.name 'github-actions[bot]'\n          git config --global user.email '41898282+github-actions[bot]@users.noreply.github.com'\n          git add mini/*\n          if ! git diff --staged --quiet; then\n            git commit -m \"chore: update laporan &amp; badge konten\" --author=\"frijal &lt;5477182+frijal@users.noreply.github.com&gt;\"\n            git pull origin main --rebase\n            git push\n          else\n            echo \"‚úÖ Tidak ada perubahan baru untuk di-commit.\"\n          fi</code></pre>\n  \n  </main>"
  },
  "meta": {
    "summary": "Workflow GitHub Actions untuk otomatis membersihkan gambar orphan dan membuat laporan konten harian di dalam.web.id. Dilengkapi penjelasan lengkap dan kode siap pakai.",
    "keywords": [],
    "topics": [],
    "prompt_hint": "Workflow GitHub Actions untuk otomatis membersihkan gambar orphan dan membuat laporan konten harian di dalam.web.id. Dilengkapi penjelasan lengkap dan kode siap pakai."
  }
}