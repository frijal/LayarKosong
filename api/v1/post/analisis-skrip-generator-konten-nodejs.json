{
  "id": "analisis-skrip-generator-konten-nodejs",
  "slug": "analisis-skrip-generator-konten-nodejs",
  "title": "Bedah Skrip Generator Konten Cerdas (Node.js)",
  "category": "üñ•Ô∏è Teknologi Web, AI & Umum",
  "published_at": "2025-10-22T12:23:43.380+00:00",
  "url": "https://dalam.web.id/artikel/analisis-skrip-generator-konten-nodejs.html",
  "image": "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFck_UrHNNPuq7efqdzls4mrrPJv3ZRlKibwYD3w1FVCgAu0NlzQz2LDieWiUg2nsgJiFT_dr-oShXctQ3K1BckCglQ0rkOoxuYC9ceIYwSRIqt14efmNgMJDoYqBtyJalfWy3Eok6yKh-08bSSYmvyFfE7ZWpqqk9_hVC-sI8wUdjycBO22uAwFoCu-E/s1600/licensed-image.webp",
  "content": {
    "text": "Tujuan Utama: Sang Asisten Digital Pada dasarnya, skrip ini adalah asisten digital yang mengambil alih semua tugas membosankan. Tujuannya adalah membaca semua artikel .html, mengekstrak data penting, lalu menghasilkan tiga hal utama: Sebuah \"database\" pusat dalam format JSON (artikel.json). Sebuah sitemap.xml yang selalu up-to-date untuk SEO. Halaman-halaman kategori artikel yang dibuat secara otomatis. Alur Kerja: Bagaimana Si Cerdas Bekerja Skrip ini tidak hanya bekerja, tapi bekerja dengan alur yang efisien dan tangguh. Berikut adalah visualisasi prosesnya: Kode Lengkap: generator.js Berikut adalah kode lengkap dari skrip generator konten cerdas yang kita bedah di atas. import fs from 'fs/promises'; import path from 'path'; import { fileURLToPath } from 'url'; import { titleToCategory } from './titleToCategory.js'; // ================================================================== // KONFIGURASI TERPUSAT // =================================================================== const __filename = fileURLToPath(import.meta.url); const __dirname = path.dirname(__filename); const CONFIG = { rootDir: path.join(__dirname, '..'), artikelDir: path.join(__dirname, '..', 'artikel'), masterJson: path.join(__dirname, '..', 'artikel', 'artikel.json'), jsonOut: path.join(__dirname, '..', 'artikel.json'), xmlOut: path.join(__dirname, '..', 'sitemap.xml'), baseUrl: 'https://dalam.web.id', defaultThumbnail: 'https://dalam.web.id/thumbnail.webp', xmlPriority: '0.6', xmlChangeFreq: 'monthly', }; // =================================================================== // FUNGSI-FUNGSI BANTUAN (HELPER FUNCTIONS) // =================================================================== function formatISO8601(date) { const d = new Date(date); if (isNaN(d)) { console.warn(`‚ö†Ô∏è Tanggal tidak valid, fallback ke sekarang.`); return new Date().toISOString(); } const tzOffset = -d.getTimezoneOffset(); const diff = tzOffset >= 0 ? '+' : '-'; const pad = (n) => String(Math.floor(Math.abs(n))).padStart(2, '0'); const hours = pad(tzOffset / 60); const minutes = pad(tzOffset % 60); return d.toISOString().replace('Z', `${diff}${hours}:${minutes}`); } function extractPubDate(content) { const match = content.match( /<meta\\s+property=[\"']article:published_time[\"'][^>]+content=[\"']([^\"']+)[\"']/i, ); return match ? match[1].trim() : null; } function extractTitle(content) { const match = content.match(/<title>([\\s\\S]*?)<\\/title>/i); return match ? match[1].trim() : 'Tanpa Judul'; } function extractDescription(content) { const match = content.match( /<meta\\s+name=[\"']description[\"'][^>]+content=[\"']([^\"']+)[\"']/i, ); return match ? match[1].trim() : ''; } function fixTitleOneLine(content) { return content.replace( /<title>([\\s\\S]*?)<\\/title>/gi, (m, p1) => `<title>${p1.trim()}</title>`, ); } function extractImage(content) { const ogMatch = content.match( /<meta[^>]+property=[\"']og:image[\"'][^>]+content=[\"'](.*?)[\"']/i, ); if (ogMatch && ogMatch[1]) { const src = ogMatch[1].trim(); const validExt = /\\.(jpe?g|png|gif|webp|avif|svg)$/i; if (validExt.test(src.split('?')[0])) return src; } const imgMatch = content.match(/<img[^>]+src=[\"'](.*?)[\"']/i); if (imgMatch && imgMatch[1]) { const src = imgMatch[1].trim(); const validExt = /\\.(jpe?g|png|gif|webp|avif|svg)$/i; if (validExt.test(src.split('?')[0])) return src; } return CONFIG.defaultThumbnail; } function formatJsonOutput(obj) { return JSON.stringify(obj, null, 2) .replace(/\\[\\s*\\[/g, '[\\n [') .replace(/\\]\\s*\\]/g, ']\\n ]') .replace(/(\\],)\\s*\\[/g, '$1\\n ['); } async function generateCategoryPages(groupedData) { console.log('üîÑ Memulai pembuatan halaman kategori...'); const kategoriDir = path.join(CONFIG.artikelDir, '-'); const templatePath = path.join(kategoriDir, 'template-kategori.html'); try { await fs.access(templatePath); const templateContent = await fs.readFile(templatePath, 'utf8'); for (const categoryName in groupedData) { // Hilangkan emoji & ubah ke slug const noEmoji = categoryName.replace(/^[^\\w\\s]*/, '').trim(); const slug = noEmoji .toLowerCase() .replace(/ & /g, '-and-') .replace(/[^a-z0-9\\s-]/g, '') .replace(/\\s+/g, '-') .replace(/-+/g, '-'); // RSS URL untuk kategori const rssUrl = `${CONFIG.baseUrl}/feed-${slug}.xml`; // URL halaman kategori const fileName = `${slug}.html`; const canonicalUrl = `${CONFIG.baseUrl}/artikel/-/${fileName}`; // Ambil emoji pertama (atau fallback) const icon = categoryName.match(/(\\p{Emoji})/u)?.[0] || 'üìÅ'; // Ganti placeholder di template let pageContent = templateContent .replace(/%%TITLE%%/g, noEmoji) .replace(/%%DESCRIPTION%%/g, `topik ${noEmoji}`) .replace(/%%CANONICAL_URL%%/g, canonicalUrl) .replace(/%%CATEGORY_NAME%%/g, categoryName) .replace(/%%ICON%%/g, icon) .replace(/%%RSS_URL%%/g, rssUrl); // Tulis file HTML hasil render await fs.writeFile(path.join(kategoriDir, fileName), pageContent, 'utf8'); console.log(`‚úÖ Halaman kategori dibuat: ${fileName}`); } console.log('üëç Semua halaman kategori berhasil dibuat.'); } catch (error) { console.error( \"‚ùå Gagal membuat halaman kategori. Pastikan 'template-kategori.html' ada di dalam folder 'artikel/-'.\", error.message, ); } } // =================================================================== // FUNGSI UTAMA (MAIN GENERATOR) // =================================================================== const generate = async () => { console.log('üöÄ Memulai proses generator...'); try { await fs.access(CONFIG.artikelDir); } catch { console.error(\"‚ùå Folder 'artikel' tidak ditemukan. Proses dibatalkan.\"); return; } const filesOnDisk = (await fs.readdir(CONFIG.artikelDir)).filter((f) => f.endsWith('.html'), ); const existingFilesOnDisk = new Set(filesOnDisk); let grouped = {}; try { const masterContent = await fs.readFile(CONFIG.masterJson, 'utf8'); grouped = JSON.parse(masterContent); console.log('üìÇ Master JSON berhasil dimuat.'); } catch { console.warn( '‚ö†Ô∏è Master JSON (artikel/artikel.json) tidak ditemukan, memulai dari awal.', ); } const cleanedGrouped = {}; let deletedCount = 0; for (const category in grouped) { const survivingArticles = grouped[category].filter((item) => { if (!existingFilesOnDisk.has(item[1])) { console.log( `üóëÔ∏è File terhapus terdeteksi, menghapus dari data: ${item[1]}`, ); deletedCount++; return false; } return true; }); if (survivingArticles.length > 0) { cleanedGrouped[category] = survivingArticles; } } grouped = cleanedGrouped; const existingFiles = new Set( Object.values(grouped) .flat() .map((item) => item[1]), ); let newArticlesCount = 0; for (const file of filesOnDisk) { try { if (existingFiles.has(file)) continue; const fullPath = path.join(CONFIG.artikelDir, file); let content = await fs.readFile(fullPath, 'utf8'); let needsSave = false; const fixedTitleContent = fixTitleOneLine(content); if (fixedTitleContent !== content) { content = fixedTitleContent; needsSave = true; console.log(`üîß Merapikan <title> di ${file}`); } const title = extractTitle(content); const category = titleToCategory(title); const image = extractImage(content); const description = extractDescription(content); let pubDate = extractPubDate(content); if (!pubDate) { const stats = await fs.stat(fullPath); pubDate = stats.mtime; const newMetaTag = ` <meta property=\"article:published_time\" content=\"${formatISO8601(pubDate)}\">`; if (content.includes('</head>')) { content = content.replace('</head>', `${newMetaTag}\\n</head>`); needsSave = true; console.log(`‚ûï Menambahkan meta tanggal ke '${file}'`); } } if (needsSave) { await fs.writeFile(fullPath, content, 'utf8'); } const lastmod = formatISO8601(pubDate); if (!grouped[category]) grouped[category] = []; grouped[category].push([title, file, image, lastmod, description]); newArticlesCount++; console.log(`‚ûï Memproses artikel baru: ${file}`); } catch (error) { console.error(`‚ùå Gagal memproses file ${file}:`, error.message); } } // Cek apakah file output (artikel.json di root) sudah ada let isJsonOutMissing = false; try { await fs.access(CONFIG.jsonOut); } catch { isJsonOutMissing = true; console.log('üü° File output artikel.json tidak ditemukan, akan dibuat ulang.'); } // Tambahkan 'isJsonOutMissing' sebagai kondisi untuk menulis file if (newArticlesCount > 0 || deletedCount > 0 || isJsonOutMissing) { for (const category in grouped) { grouped[category].sort((a, b) => new Date(b[3]) - new Date(a[3])); } const xmlUrls = []; Object.values(grouped) .flat() .forEach((item) => { const [, file, image, lastmod] = item; xmlUrls.push( ` <url>\\n <loc>${CONFIG.baseUrl}/artikel/${file}</loc>\\n <lastmod>${lastmod}</lastmod>\\n <priority>${CONFIG.xmlPriority}</priority>\\n <changefreq>${CONFIG.xmlChangeFreq}</changefreq>\\n <image:image>\\n <image:loc>${image}</image:loc>\\n </image:image>\\n </url>`, ); }); const jsonString = formatJsonOutput(grouped); await fs.writeFile(CONFIG.jsonOut, jsonString, 'utf8'); const xmlContent = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\\n<urlset xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:image=\"http://www.google.com/schemas/sitemap-image/1.1\" xsi:schemaLocation=\"http://www.sitemaps.org/schemas/sitemap/0.9 http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd http://www.google.com/schemas/sitemap/image/1.1 http://www.google.com/schemas/sitemap/1.1/sitemap-image.xsd\" xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\">\\n${xmlUrls.join('\\n')}\\n</urlset>`; await fs.writeFile(CONFIG.xmlOut, xmlContent, 'utf8'); await generateCategoryPages(grouped); console.log( `\\n‚úÖ Ringkasan: ${newArticlesCount} artikel baru ditambahkan, ${deletedCount} artikel lama dihapus.`, ); if (isJsonOutMissing && newArticlesCount === 0 && deletedCount === 0) { console.log('‚úÖ File artikel.json di root dibuat ulang karena tidak ada.'); } console.log( '‚úÖ artikel.json, sitemap.xml, dan halaman kategori berhasil diperbarui.', ); } else { console.log('\\n‚úÖ Tidak ada perubahan. File tidak diubah.'); } }; // Menjalankan fungsi utama generate(); Salin Langkah 1: Inisialisasi & Memuat Ingatan Skrip mulai dengan memuat artikel/artikel.json. File ini bertindak sebagai \"ingatan\" atau kondisi terakhir. Jika tidak ada, ia akan memulai dari nol. Langkah 2: Pembersihan & Sinkronisasi Ini bagian cerdasnya. Skrip membandingkan \"ingatannya\" dengan file yang benar-benar ada. Jika ada artikel yang sudah dihapus, datanya akan dibersihkan dari JSON. Langkah 3: Memproses Artikel Baru Skrip mencari file .html baru yang belum ada di \"ingatannya\", lalu mengekstrak semua metadata penting: judul, deskripsi, gambar, dan tanggal. Langkah 4: Perbaikan Otomatis (Self-Healing) Jika sebuah artikel tidak punya meta tag tanggal terbit, skrip akan mengambil tanggal modifikasi file, lalu menyuntikkan tag meta yang benar ke dalam file HTML tersebut. Ajaib! Langkah 5: Menulis Output (Hanya Jika Perlu) Ini bagian efisiennya. Skrip hanya akan menulis ulang artikel.json, sitemap.xml, dan halaman kategori jika ada perubahan. Jika tidak, ia akan berhenti dan menghemat waktu. Fitur-Fitur Cerdas Lainnya Konfigurasi Terpusat Semua path dan pengaturan penting ada di satu tempat (objek CONFIG), membuatnya sangat mudah dipelihara. Fungsi yang Jelas Kode dipecah menjadi fungsi-fungsi kecil dengan satu tugas, seperti extractTitle, membuatnya mudah dibaca dan di-debug. Fallback Cerdas Jika tidak menemukan gambar di artikel, skrip akan otomatis menggunakan gambar thumbnail default yang sudah ditentukan.",
    "html": "<h2>Tujuan Utama: Sang Asisten Digital</h2>\n                <p>Pada dasarnya, skrip ini adalah asisten digital yang mengambil alih semua tugas membosankan. Tujuannya adalah membaca semua artikel <code>.html</code>, mengekstrak data penting, lalu menghasilkan tiga hal utama:</p>\n                <ol>\n                    <li>Sebuah \"database\" pusat dalam format JSON (<code>artikel.json</code>).</li>\n                    <li>Sebuah <code>sitemap.xml</code> yang selalu up-to-date untuk SEO.</li>\n                    <li>Halaman-halaman kategori artikel yang dibuat secara otomatis.</li>\n                </ol>\n\n                <h2>Alur Kerja: Bagaimana Si Cerdas Bekerja</h2>\n                <p>Skrip ini tidak hanya bekerja, tapi bekerja dengan alur yang efisien dan tangguh. Berikut adalah visualisasi prosesnya:</p>\n\n<div class=\"image-container\">\n    <img src=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFck_UrHNNPuq7efqdzls4mrrPJv3ZRlKibwYD3w1FVCgAu0NlzQz2LDieWiUg2nsgJiFT_dr-oShXctQ3K1BckCglQ0rkOoxuYC9ceIYwSRIqt14efmNgMJDoYqBtyJalfWy3Eok6yKh-08bSSYmvyFfE7ZWpqqk9_hVC-sI8wUdjycBO22uAwFoCu-E/s1600/licensed-image.webp\" alt=\"Diagram alur kerja skrip generator.js\" style=\"width:100%; height:auto; border-radius: 8px;\">\n</div>\n\n<h3>Kode Lengkap: <code>generator.js</code></h3>\n<p>Berikut adalah kode lengkap dari skrip generator konten cerdas yang kita bedah di atas.</p>\n\n<div class=\"code-block\">\n    <pre><code>import fs from 'fs/promises';\nimport path from 'path';\nimport { fileURLToPath } from 'url';\nimport { titleToCategory } from './titleToCategory.js';\n\n// ==================================================================\n// KONFIGURASI TERPUSAT\n// ===================================================================\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\n\nconst CONFIG = {\n  rootDir: path.join(__dirname, '..'),\n  artikelDir: path.join(__dirname, '..', 'artikel'),\n  masterJson: path.join(__dirname, '..', 'artikel', 'artikel.json'),\n  jsonOut: path.join(__dirname, '..', 'artikel.json'),\n  xmlOut: path.join(__dirname, '..', 'sitemap.xml'),\n  baseUrl: 'https://dalam.web.id',\n  defaultThumbnail: 'https://dalam.web.id/thumbnail.webp',\n  xmlPriority: '0.6',\n  xmlChangeFreq: 'monthly',\n};\n\n// ===================================================================\n// FUNGSI-FUNGSI BANTUAN (HELPER FUNCTIONS)\n// ===================================================================\n\nfunction formatISO8601(date) {\n  const d = new Date(date);\n  if (isNaN(d)) {\n    console.warn(`‚ö†Ô∏è Tanggal tidak valid, fallback ke sekarang.`);\n    return new Date().toISOString();\n  }\n  const tzOffset = -d.getTimezoneOffset();\n  const diff = tzOffset &gt;= 0 ? '+' : '-';\n  const pad = (n) =&gt; String(Math.floor(Math.abs(n))).padStart(2, '0');\n  const hours = pad(tzOffset / 60);\n  const minutes = pad(tzOffset % 60);\n  return d.toISOString().replace('Z', `${diff}${hours}:${minutes}`);\n}\n\nfunction extractPubDate(content) {\n  const match = content.match(\n    /&lt;meta\\s+property=[\"']article:published_time[\"'][^&gt;]+content=[\"']([^\"']+)[\"']/i,\n  );\n  return match ? match[1].trim() : null;\n}\n\nfunction extractTitle(content) {\n  const match = content.match(/&lt;title&gt;([\\s\\S]*?)&lt;\\/title&gt;/i);\n  return match ? match[1].trim() : 'Tanpa Judul';\n}\n\nfunction extractDescription(content) {\n  const match = content.match(\n    /&lt;meta\\s+name=[\"']description[\"'][^&gt;]+content=[\"']([^\"']+)[\"']/i,\n  );\n  return match ? match[1].trim() : '';\n}\n\nfunction fixTitleOneLine(content) {\n  return content.replace(\n    /&lt;title&gt;([\\s\\S]*?)&lt;\\/title&gt;/gi,\n    (m, p1) =&gt; `&lt;title&gt;${p1.trim()}&lt;/title&gt;`,\n  );\n}\n\nfunction extractImage(content) {\n  const ogMatch = content.match(\n    /&lt;meta[^&gt;]+property=[\"']og:image[\"'][^&gt;]+content=[\"'](.*?)[\"']/i,\n  );\n  if (ogMatch &amp;&amp; ogMatch[1]) {\n    const src = ogMatch[1].trim();\n    const validExt = /\\.(jpe?g|png|gif|webp|avif|svg)$/i;\n    if (validExt.test(src.split('?')[0])) return src;\n  }\n\n  const imgMatch = content.match(/&lt;img[^&gt;]+src=[\"'](.*?)[\"']/i);\n  if (imgMatch &amp;&amp; imgMatch[1]) {\n    const src = imgMatch[1].trim();\n    const validExt = /\\.(jpe?g|png|gif|webp|avif|svg)$/i;\n    if (validExt.test(src.split('?')[0])) return src;\n  }\n\n  return CONFIG.defaultThumbnail;\n}\n\nfunction formatJsonOutput(obj) {\n  return JSON.stringify(obj, null, 2)\n    .replace(/\\[\\s*\\[/g, '[\\n      [')\n    .replace(/\\]\\s*\\]/g, ']\\n    ]')\n    .replace(/(\\],)\\s*\\[/g, '$1\\n      [');\n}\n\nasync function generateCategoryPages(groupedData) {\n  console.log('üîÑ Memulai pembuatan halaman kategori...');\n  const kategoriDir = path.join(CONFIG.artikelDir, '-');\n  const templatePath = path.join(kategoriDir, 'template-kategori.html');\n\n  try {\n    await fs.access(templatePath);\n    const templateContent = await fs.readFile(templatePath, 'utf8');\n\n    for (const categoryName in groupedData) {\n      // Hilangkan emoji &amp; ubah ke slug\n      const noEmoji = categoryName.replace(/^[^\\w\\s]*/, '').trim();\n      const slug = noEmoji\n        .toLowerCase()\n        .replace(/ &amp; /g, '-and-')\n        .replace(/[^a-z0-9\\s-]/g, '')\n        .replace(/\\s+/g, '-')\n        .replace(/-+/g, '-');\n\n      // RSS URL untuk kategori\n      const rssUrl = `${CONFIG.baseUrl}/feed-${slug}.xml`;\n\n      // URL halaman kategori\n      const fileName = `${slug}.html`;\n      const canonicalUrl = `${CONFIG.baseUrl}/artikel/-/${fileName}`;\n\n      // Ambil emoji pertama (atau fallback)\n      const icon = categoryName.match(/(\\p{Emoji})/u)?.[0] || 'üìÅ';\n\n      // Ganti placeholder di template\n      let pageContent = templateContent\n        .replace(/%%TITLE%%/g, noEmoji)\n        .replace(/%%DESCRIPTION%%/g, `topik ${noEmoji}`)\n        .replace(/%%CANONICAL_URL%%/g, canonicalUrl)\n        .replace(/%%CATEGORY_NAME%%/g, categoryName)\n        .replace(/%%ICON%%/g, icon)\n        .replace(/%%RSS_URL%%/g, rssUrl);\n\n      // Tulis file HTML hasil render\n      await fs.writeFile(path.join(kategoriDir, fileName), pageContent, 'utf8');\n      console.log(`‚úÖ Halaman kategori dibuat: ${fileName}`);\n    }\n\n    console.log('üëç Semua halaman kategori berhasil dibuat.');\n  } catch (error) {\n    console.error(\n      \"‚ùå Gagal membuat halaman kategori. Pastikan 'template-kategori.html' ada di dalam folder 'artikel/-'.\",\n      error.message,\n    );\n  }\n}\n\n// ===================================================================\n// FUNGSI UTAMA (MAIN GENERATOR)\n// ===================================================================\nconst generate = async () =&gt; {\n  console.log('üöÄ Memulai proses generator...');\n  try {\n    await fs.access(CONFIG.artikelDir);\n  } catch {\n    console.error(\"‚ùå Folder 'artikel' tidak ditemukan. Proses dibatalkan.\");\n    return;\n  }\n\n  const filesOnDisk = (await fs.readdir(CONFIG.artikelDir)).filter((f) =&gt;\n    f.endsWith('.html'),\n  );\n  const existingFilesOnDisk = new Set(filesOnDisk);\n  let grouped = {};\n\n  try {\n    const masterContent = await fs.readFile(CONFIG.masterJson, 'utf8');\n    grouped = JSON.parse(masterContent);\n    console.log('üìÇ Master JSON berhasil dimuat.');\n  } catch {\n    console.warn(\n      '‚ö†Ô∏è Master JSON (artikel/artikel.json) tidak ditemukan, memulai dari awal.',\n    );\n  }\n\n  const cleanedGrouped = {};\n  let deletedCount = 0;\n  for (const category in grouped) {\n    const survivingArticles = grouped[category].filter((item) =&gt; {\n      if (!existingFilesOnDisk.has(item[1])) {\n        console.log(\n          `üóëÔ∏è File terhapus terdeteksi, menghapus dari data: ${item[1]}`,\n        );\n        deletedCount++;\n        return false;\n      }\n      return true;\n    });\n    if (survivingArticles.length &gt; 0) {\n      cleanedGrouped[category] = survivingArticles;\n    }\n  }\n  grouped = cleanedGrouped;\n\n  const existingFiles = new Set(\n    Object.values(grouped)\n      .flat()\n      .map((item) =&gt; item[1]),\n  );\n  let newArticlesCount = 0;\n\n  for (const file of filesOnDisk) {\n    try {\n      if (existingFiles.has(file)) continue;\n\n      const fullPath = path.join(CONFIG.artikelDir, file);\n      let content = await fs.readFile(fullPath, 'utf8');\n      let needsSave = false;\n\n      const fixedTitleContent = fixTitleOneLine(content);\n      if (fixedTitleContent !== content) {\n        content = fixedTitleContent;\n        needsSave = true;\n        console.log(`üîß Merapikan &lt;title&gt; di ${file}`);\n      }\n\n      const title = extractTitle(content);\n      const category = titleToCategory(title);\n      const image = extractImage(content);\n      const description = extractDescription(content);\n\n      let pubDate = extractPubDate(content);\n      if (!pubDate) {\n        const stats = await fs.stat(fullPath);\n        pubDate = stats.mtime;\n        const newMetaTag = `      &lt;meta property=\"article:published_time\" content=\"${formatISO8601(pubDate)}\"&gt;`;\n        if (content.includes('&lt;/head&gt;')) {\n          content = content.replace('&lt;/head&gt;', `${newMetaTag}\\n&lt;/head&gt;`);\n          needsSave = true;\n          console.log(`‚ûï Menambahkan meta tanggal ke '${file}'`);\n        }\n      }\n\n      if (needsSave) {\n        await fs.writeFile(fullPath, content, 'utf8');\n      }\n\n      const lastmod = formatISO8601(pubDate);\n      if (!grouped[category]) grouped[category] = [];\n      grouped[category].push([title, file, image, lastmod, description]);\n      newArticlesCount++;\n      console.log(`‚ûï Memproses artikel baru: ${file}`);\n    } catch (error) {\n      console.error(`‚ùå Gagal memproses file ${file}:`, error.message);\n    }\n  }\n\n  // Cek apakah file output (artikel.json di root) sudah ada\n  let isJsonOutMissing = false;\n  try {\n    await fs.access(CONFIG.jsonOut);\n  } catch {\n    isJsonOutMissing = true;\n    console.log('üü° File output artikel.json tidak ditemukan, akan dibuat ulang.');\n  }\n\n  // Tambahkan 'isJsonOutMissing' sebagai kondisi untuk menulis file\n  if (newArticlesCount &gt; 0 || deletedCount &gt; 0 || isJsonOutMissing) {\n    for (const category in grouped) {\n      grouped[category].sort((a, b) =&gt; new Date(b[3]) - new Date(a[3]));\n    }\n\n    const xmlUrls = [];\n    Object.values(grouped)\n      .flat()\n      .forEach((item) =&gt; {\n        const [, file, image, lastmod] = item;\n        xmlUrls.push(\n          `  &lt;url&gt;\\n    &lt;loc&gt;${CONFIG.baseUrl}/artikel/${file}&lt;/loc&gt;\\n    &lt;lastmod&gt;${lastmod}&lt;/lastmod&gt;\\n    &lt;priority&gt;${CONFIG.xmlPriority}&lt;/priority&gt;\\n    &lt;changefreq&gt;${CONFIG.xmlChangeFreq}&lt;/changefreq&gt;\\n    &lt;image:image&gt;\\n      &lt;image:loc&gt;${image}&lt;/image:loc&gt;\\n    &lt;/image:image&gt;\\n  &lt;/url&gt;`,\n        );\n      });\n\n    const jsonString = formatJsonOutput(grouped);\n    await fs.writeFile(CONFIG.jsonOut, jsonString, 'utf8');\n\n    const xmlContent = `&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\\n&lt;urlset xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:image=\"http://www.google.com/schemas/sitemap-image/1.1\" xsi:schemaLocation=\"http://www.sitemaps.org/schemas/sitemap/0.9 http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd http://www.google.com/schemas/sitemap/image/1.1 http://www.google.com/schemas/sitemap/1.1/sitemap-image.xsd\" xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\"&gt;\\n${xmlUrls.join('\\n')}\\n&lt;/urlset&gt;`;\n    await fs.writeFile(CONFIG.xmlOut, xmlContent, 'utf8');\n\n    await generateCategoryPages(grouped);\n\n    console.log(\n      `\\n‚úÖ Ringkasan: ${newArticlesCount} artikel baru ditambahkan, ${deletedCount} artikel lama dihapus.`,\n    );\n    if (isJsonOutMissing &amp;&amp; newArticlesCount === 0 &amp;&amp; deletedCount === 0) {\n        console.log('‚úÖ File artikel.json di root dibuat ulang karena tidak ada.');\n    }\n    console.log(\n      '‚úÖ artikel.json, sitemap.xml, dan halaman kategori berhasil diperbarui.',\n    );\n  } else {\n    console.log('\\n‚úÖ Tidak ada perubahan. File tidak diubah.');\n  }\n};\n\n// Menjalankan fungsi utama\ngenerate();\n</code></pre>\n    <button class=\"copy-btn\"><i class=\"far fa-copy\"></i> Salin</button>\n</div>\n\n                <div class=\"timeline\">\n                    <div class=\"timeline-item\">\n                        <div class=\"timeline-icon init\"><i class=\"fas fa-memory\"></i></div>\n                        <div class=\"timeline-content\">\n                            <h3>Langkah 1: Inisialisasi &amp; Memuat Ingatan</h3>\n                            <p>Skrip mulai dengan memuat <code>artikel/artikel.json</code>. File ini bertindak sebagai \"ingatan\" atau kondisi terakhir. Jika tidak ada, ia akan memulai dari nol.</p>\n                        </div>\n                    </div>\n                    <div class=\"timeline-item\">\n                        <div class=\"timeline-icon clean\"><i class=\"fas fa-sync-alt\"></i></div>\n                        <div class=\"timeline-content\">\n                            <h3>Langkah 2: Pembersihan &amp; Sinkronisasi</h3>\n                            <p>Ini bagian cerdasnya. Skrip membandingkan \"ingatannya\" dengan file yang benar-benar ada. Jika ada artikel yang sudah dihapus, datanya akan dibersihkan dari JSON.</p>\n                        </div>\n                    </div>\n                    <div class=\"timeline-item\">\n                        <div class=\"timeline-icon process\"><i class=\"fas fa-cogs\"></i></div>\n                        <div class=\"timeline-content\">\n                            <h3>Langkah 3: Memproses Artikel Baru</h3>\n                            <p>Skrip mencari file <code>.html</code> baru yang belum ada di \"ingatannya\", lalu mengekstrak semua metadata penting: judul, deskripsi, gambar, dan tanggal.</p>\n                        </div>\n                    </div>\n                    <div class=\"timeline-item\">\n                        <div class=\"timeline-icon heal\"><i class=\"fas fa-magic\"></i></div>\n                        <div class=\"timeline-content\">\n                            <h3>Langkah 4: Perbaikan Otomatis (Self-Healing)</h3>\n                            <p>Jika sebuah artikel tidak punya meta tag tanggal terbit, skrip akan mengambil tanggal modifikasi file, lalu <strong>menyuntikkan tag meta yang benar</strong> ke dalam file HTML tersebut. Ajaib!</p>\n                        </div>\n                    </div>\n                    <div class=\"timeline-item\">\n                        <div class=\"timeline-icon write\"><i class=\"fas fa-file-export\"></i></div>\n                        <div class=\"timeline-content\">\n                            <h3>Langkah 5: Menulis Output (Hanya Jika Perlu)</h3>\n                            <p>Ini bagian efisiennya. Skrip hanya akan menulis ulang <code>artikel.json</code>, <code>sitemap.xml</code>, dan halaman kategori <strong>jika ada perubahan</strong>. Jika tidak, ia akan berhenti dan menghemat waktu.</p>\n                        </div>\n                    </div>\n                </div>\n\n                <h3>Fitur-Fitur Cerdas Lainnya</h3>\n                <div class=\"features-grid\">\n                    <div class=\"feature-item\">\n                        <i class=\"fas fa-cog\"></i>\n                        <h4>Konfigurasi Terpusat</h4>\n                        <p>Semua path dan pengaturan penting ada di satu tempat (objek <code>CONFIG</code>), membuatnya sangat mudah dipelihara.</p>\n                    </div>\n                    <div class=\"feature-item\">\n                        <i class=\"fas fa-puzzle-piece\"></i>\n                        <h4>Fungsi yang Jelas</h4>\n                        <p>Kode dipecah menjadi fungsi-fungsi kecil dengan satu tugas, seperti <code>extractTitle</code>, membuatnya mudah dibaca dan di-debug.</p>\n                    </div>\n                    <div class=\"feature-item\">\n                        <i class=\"fas fa-image\"></i>\n                        <h4>Fallback Cerdas</h4>\n                        <p>Jika tidak menemukan gambar di artikel, skrip akan otomatis menggunakan gambar thumbnail default yang sudah ditentukan.</p>\n                    </div>\n                </div>"
  },
  "meta": {
    "summary": "Bedah tuntas skrip Node.js canggih yang mengotomatiskan pembuatan artikel.json, sitemap.xml, dan halaman kategori, lengkap dengan fitur self-healing.",
    "keywords": [],
    "topics": [],
    "prompt_hint": "Bedah tuntas skrip Node.js canggih yang mengotomatiskan pembuatan artikel.json, sitemap.xml, dan halaman kategori, lengkap dengan fitur self-healing."
  }
}