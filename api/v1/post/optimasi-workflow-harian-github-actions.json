{
  "id": "optimasi-workflow-harian-github-actions",
  "slug": "optimasi-workflow-harian-github-actions",
  "title": "Workflow Cerdas: Satu Job untuk Semua Tugas Perawatan Harian",
  "category": "üñ•Ô∏è Teknologi Web, AI & Umum",
  "published_at": "2025-10-22T11:53:56.641+00:00",
  "url": "https://dalam.web.id/artikel/optimasi-workflow-harian-github-actions.html",
  "image": "https://dalam.web.id/img/optimasi-workflow-harian-github-actions.webp",
  "content": {
    "text": "Masalahnya: Terlalu Banyak Job, Terlalu Boros Awalnya, saya punya workflow harian yang dibagi menjadi beberapa job: satu untuk membersihkan gambar, satu lagi untuk membuat laporan. Secara logika ini benar, tapi secara teknis sangat tidak efisien. Kenapa? Boros `checkout`: Setiap job harus melakukan `checkout` repositori dari awal. Ini membuang waktu. Riwayat Commit Berantakan: Setiap job membuat commit-nya sendiri-sendiri, menghasilkan riwayat Git yang \"berisik\". Potensi Masalah Timing: Data yang digunakan oleh job kedua mungkin sudah usang karena tidak melihat perubahan yang dibuat oleh job pertama. Solusinya? Rombak total dan gabungkan semuanya ke dalam satu job tunggal dengan urutan proses yang logis. Solusi: Satu Alur Kerja, Satu Tujuan Dengan satu job, kita bisa mengatur urutan tugas dengan sempurna: **buat dulu aset baru**, **bersihkan yang lama**, lalu **laporkan kondisi finalnya**. Semua dalam satu proses yang mulus. Langkah 1: Buat Aset Baru (Generate Screenshots) Proses dimulai dengan membuat aset yang mungkin belum ada. Skrip Puppeteer dijalankan untuk membuat screenshot artikel yang belum memiliki gambar cover. Langkah 2: Bersihkan Aset Lama (Cleanup Orphans) Setelah semua gambar yang seharusnya ada sudah dibuat, sekarang waktunya bersih-bersih. Skrip akan mencari gambar `.webp` yang artikelnya sudah tidak ada lagi (orphan) dan menghapusnya. Langkah 3: Laporkan Kondisi Final (Count & Report) Setelah semua aset ada di tempatnya dan yang tidak perlu sudah dibuang, barulah kita menghitung dan membuat laporan. Hasil laporan ini akan menjadi cerminan akurat dari kondisi repo saat itu. Langkah Final: Satu Commit untuk Semua Inilah bagian terbaiknya. Semua perubahan‚Äîgambar baru, gambar yang dihapus, dan laporan baru‚Äîdikemas ke dalam satu commit atomik. Riwayat Git menjadi bersih dan mudah dibaca. Kode Final Workflow: Inilah wujud akhir dari workflow yang sudah dioptimalkan. Satu job, satu tujuan, efisiensi maksimal. name: üîÜ Perawatan & Laporan Konten Harian on: schedule: - cron: '0 21 * * *' workflow_dispatch: jobs: maintenance_and_reporting: runs-on: ubuntu-latest permissions: contents: write steps: - name: '1. Checkout Repository' uses: actions/checkout@v4 with: { fetch-depth: 0 } - name: '2. Setup Node.js' uses: actions/setup-node@v4 with: { node-version: '20' } - name: '3. Generate Missing Screenshots' run: | npm install puppeteer --no-save node ext/screenshot-puppeteer.js - name: '4. Cari dan Hapus Gambar Orphan' id: cleanup_step run: | # ... (script cleanup) ... - name: '5. Hitung File & Buat Laporan' run: | # ... (script reporting) ... - name: '6. Rotasi Laporan Lama' run: | # ... (script rotasi) ... - name: '7. Hapus File Sementara' run: rm -rf tmp/ __pycache__/ - name: '8. Commit All Changes' run: | git config --global user.name 'github-actions[bot]' git config --global user.email '41898282+github-actions[bot]@users.noreply.github.com' git add img/ mini/ if ! git diff --staged --quiet; then git commit -m \"chore: Daily maintenance (screenshots, cleanup, report)\" git pull origin main --rebase git push else echo \"‚úÖ Tidak ada perubahan baru.\" fi Salin",
    "html": "<h2>Masalahnya: Terlalu Banyak Job, Terlalu Boros</h2>\n                <p>Awalnya, saya punya workflow harian yang dibagi menjadi beberapa job: satu untuk membersihkan gambar, satu lagi untuk membuat laporan. Secara logika ini benar, tapi secara teknis sangat tidak efisien. Kenapa?</p>\n                <div class=\"problem-box\">\n                    <ul>\n                        <li><i class=\"fas fa-undo\"></i> <strong>Boros `checkout`</strong>: Setiap job harus melakukan `checkout` repositori dari awal. Ini membuang waktu.</li>\n                        <li><i class=\"fas fa-random\"></i> <strong>Riwayat Commit Berantakan</strong>: Setiap job membuat commit-nya sendiri-sendiri, menghasilkan riwayat Git yang \"berisik\".</li>\n                        <li><i class=\"fas fa-hourglass-half\"></i> <strong>Potensi Masalah Timing</strong>: Data yang digunakan oleh job kedua mungkin sudah usang karena tidak melihat perubahan yang dibuat oleh job pertama.</li>\n                    </ul>\n                </div>\n\n                <p>Solusinya? Rombak total dan gabungkan semuanya ke dalam <strong>satu job tunggal</strong> dengan urutan proses yang logis.</p>\n                <h2>Solusi: Satu Alur Kerja, Satu Tujuan</h2>\n                <p>Dengan satu job, kita bisa mengatur urutan tugas dengan sempurna: **buat dulu aset baru**, **bersihkan yang lama**, lalu **laporkan kondisi finalnya**. Semua dalam satu proses yang mulus.</p>\n\n                <div class=\"timeline\">\n                    <div class=\"timeline-item\">\n                        <div class=\"timeline-icon generate\"><i class=\"fas fa-camera-retro\"></i></div>\n                        <div class=\"timeline-content\">\n                            <h3>Langkah 1: Buat Aset Baru (Generate Screenshots)</h3>\n                            <p>Proses dimulai dengan membuat aset yang mungkin belum ada. Skrip Puppeteer dijalankan untuk membuat screenshot artikel yang belum memiliki gambar cover.</p>\n                        </div>\n                    </div>\n                    <div class=\"timeline-item\">\n                        <div class=\"timeline-icon cleanup\"><i class=\"fas fa-broom\"></i></div>\n                        <div class=\"timeline-content\">\n                            <h3>Langkah 2: Bersihkan Aset Lama (Cleanup Orphans)</h3>\n                            <p>Setelah semua gambar yang seharusnya ada sudah dibuat, sekarang waktunya bersih-bersih. Skrip akan mencari gambar `.webp` yang artikelnya sudah tidak ada lagi (orphan) dan menghapusnya.</p>\n                        </div>\n                    </div>\n                    <div class=\"timeline-item\">\n                        <div class=\"timeline-icon report\"><i class=\"fas fa-chart-bar\"></i></div>\n                        <div class=\"timeline-content\">\n                            <h3>Langkah 3: Laporkan Kondisi Final (Count &amp; Report)</h3>\n                            <p>Setelah semua aset ada di tempatnya dan yang tidak perlu sudah dibuang, barulah kita menghitung dan membuat laporan. Hasil laporan ini akan menjadi cerminan akurat dari kondisi repo saat itu.</p>\n                        </div>\n                    </div>\n                    <div class=\"timeline-item\">\n                        <div class=\"timeline-icon commit\"><i class=\"fab fa-git-alt\"></i></div>\n                        <div class=\"timeline-content\">\n                            <h3>Langkah Final: Satu Commit untuk Semua</h3>\n                            <p>Inilah bagian terbaiknya. Semua perubahan‚Äîgambar baru, gambar yang dihapus, dan laporan baru‚Äîdikemas ke dalam <strong>satu commit atomik</strong>. Riwayat Git menjadi bersih dan mudah dibaca.</p>\n                        </div>\n                    </div>\n                </div>\n                <h3>Kode Final Workflow:</h3>\n                <p>Inilah wujud akhir dari workflow yang sudah dioptimalkan. Satu job, satu tujuan, efisiensi maksimal.</p>\n                <div class=\"code-block\">\n                    <pre><code>name: üîÜ Perawatan &amp; Laporan Konten Harian\non:\n  schedule:\n    - cron: '0 21 * * *'\n  workflow_dispatch:\njobs:\n  maintenance_and_reporting:\n    runs-on: ubuntu-latest\n    permissions:\n      contents: write\n    steps:\n      - name: '1. Checkout Repository'\n        uses: actions/checkout@v4\n        with: { fetch-depth: 0 }\n      - name: '2. Setup Node.js'\n        uses: actions/setup-node@v4\n        with: { node-version: '20' }\n      - name: '3. Generate Missing Screenshots'\n        run: |\n          npm install puppeteer --no-save\n          node ext/screenshot-puppeteer.js\n      - name: '4. Cari dan Hapus Gambar Orphan'\n        id: cleanup_step\n        run: |\n          # ... (script cleanup) ...\n      - name: '5. Hitung File &amp; Buat Laporan'\n        run: |\n          # ... (script reporting) ...\n      - name: '6. Rotasi Laporan Lama'\n        run: |\n          # ... (script rotasi) ...\n      - name: '7. Hapus File Sementara'\n        run: rm -rf tmp/ __pycache__/\n      - name: '8. Commit All Changes'\n        run: |\n          git config --global user.name 'github-actions[bot]'\n          git config --global user.email '41898282+github-actions[bot]@users.noreply.github.com'\n          git add img/ mini/\n          if ! git diff --staged --quiet; then\n            git commit -m \"chore: Daily maintenance (screenshots, cleanup, report)\"\n            git pull origin main --rebase\n            git push\n          else\n            echo \"‚úÖ Tidak ada perubahan baru.\"\n          fi</code></pre>\n                    <button class=\"copy-btn\"><i class=\"far fa-copy\"></i> Salin</button>\n                </div>"
  },
  "meta": {
    "summary": "Tutorial cara mengoptimalkan workflow GitHub Actions dengan menggabungkan beberapa job (screenshots, cleanup, reporting) menjadi satu job tunggal yang efisien dan atomik.",
    "prompt_hint": "Tutorial cara mengoptimalkan workflow GitHub Actions dengan menggabungkan beberapa job (screenshots, cleanup, reporting) menjadi satu job tunggal yang efisien dan atomik.",
    "keywords": [],
    "topics": []
  }
}