document.addEventListener("DOMContentLoaded",async()=>{let N=document.getElementById("main-header");if(N)new ResizeObserver((F)=>{for(let B of F)document.body.style.paddingTop=`${B.contentRect.height}px`}).observe(N);let P=document.documentElement,_=(b)=>{P.classList.toggle("dark",b==="dark"),P.classList.toggle("light",b==="light"),localStorage.setItem("theme",b)},$=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");_($);let W=document.getElementById("current-year");if(W)W.textContent=new Date().getFullYear().toString();let A=document.getElementById("search-results"),G=document.getElementById("loading-indicator"),X=document.getElementById("search-query-display"),E=new URLSearchParams(window.location.search).get("q")?.trim()||"";if(X)X.innerHTML=E?`Hasil Pencarian untuk: <span class="font-bold">"${E}"</span>`:"Pencarian",document.title=E?`${E} - Cari di Layar Kosong`:"Pencarian di Layar Kosong";if(!E){if(G)G.style.display="none";if(A)A.innerHTML='<p class="text-center text-red-500 py-10">Silakan ketik kata kunci pada kolom pencarian...</p>';return}fetch("artikel.json").then((b)=>{if(!b.ok)throw Error("Gagal ambil data");return b.json()}).then((b)=>{let F=[],B=E.toLowerCase();if(Object.entries(b).forEach(([H,j])=>{let J=H.toLowerCase().replace(/\s+/g,"-");j.forEach((K)=>{let[M,z,v,L,Z]=K;if(M?.toLowerCase().includes(B)||Z?.toLowerCase().includes(B))F.push({title:M,filename:z,imageUrl:v,dateISO:L,description:Z,category:H,catSlug:J})})}),G)G.style.display="none";k(F,E)}).catch((b)=>{if(G)G.style.display="none";if(A)A.innerHTML=`<p class="text-center text-red-500">Error: ${b.message}</p>`});function k(b,F){if(!A)return;if(b.length===0){A.innerHTML=`<p style="text-align:center; color:var(--color-fallback-text); padding: 40px 0;">Tidak ditemukan artikel untuk "${F}"</p>`;return}A.innerHTML=`<p class="text-muted">ditemukan ${b.length} judul artikel...</p>`;let B=document.createElement("div");B.className="search-grid";let H=(j)=>{if(!j)return"";let J=F.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),K=new RegExp(`(${J})`,"gi");return j.replace(K,"<mark>$1</mark>")};b.forEach((j)=>{let J=j.filename?j.filename.replace(".html",""):"#",K=`/${j.catSlug}/${J}`,M=j.dateISO?new Date(j.dateISO).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"}):"",z=document.createElement("div");z.className="result-card",z.style.display="flex",z.style.flexDirection="column",z.style.borderRadius="8px",z.style.overflow="hidden",z.style.height="100%",z.innerHTML=`
            <a href="${K}" style="text-decoration:none; color:inherit; display:flex; flex-direction:column; height:100%;">
                <img src="${j.imageUrl}" alt="${j.title}" loading="lazy" onerror="this.src='/thumbnail.webp'">
                <div class="card-content">
                    <span style="font-size: 10px; color: var(--color-primary); font-weight: bold; text-transform: uppercase;">${j.category}</span>
                    <h3 class="card-title">${H(j.title)}</h3>
                    <p class="card-desc" style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
                        ${H(j.description)}
                    </p>
                    <div style="margin-top: auto; padding-top: 10px; display: flex; justify-content: space-between; align-items: center; font-size: 10px; color: var(--color-fallback-text);">
                        <span>${M}</span>
                    </div>
                </div>
            </a>
            `,B.appendChild(z)}),A.appendChild(B)}});
