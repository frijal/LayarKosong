document.addEventListener("DOMContentLoaded",()=>{let N=document.getElementById("main-header");if(N)new ResizeObserver((B)=>{for(let z of B)document.body.style.paddingTop=`${z.contentRect.height}px`}).observe(N);let P=document.documentElement,_=(b)=>{P.classList.toggle("dark",b==="dark"),P.classList.toggle("light",b==="light"),localStorage.setItem("theme",b)},$=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");_($);let W=document.getElementById("current-year");if(W)W.textContent=new Date().getFullYear();let G=document.getElementById("search-results"),E=document.getElementById("loading-indicator"),X=document.getElementById("search-query-display"),A=new URLSearchParams(window.location.search).get("q")?.trim()||"";if(X)X.innerHTML=A?`Hasil Pencarian untuk: <span class="font-bold">"${A}"</span>`:"Pencarian",document.title=A?`${A} - Cari di Layar Kosong`:"Pencarian di Layar Kosong";if(!A){if(E)E.style.display="none";G.innerHTML='<p class="text-center text-red-500 py-10">Silakan ketik kata kunci pada kolom pencarian...</p>';return}fetch("artikel.json").then((b)=>{if(!b.ok)throw Error("Gagal ambil data");return b.json()}).then((b)=>{let B=[],z=A.toLowerCase();if(Object.entries(b).forEach(([H,j])=>{let J=H.toLowerCase().replace(/\s+/g,"-");j.forEach((K)=>{let[M,F,v,L,Z]=K;if(M?.toLowerCase().includes(z)||Z?.toLowerCase().includes(z))B.push({title:M,filename:F,imageUrl:v,dateISO:L,description:Z,category:H,catSlug:J})})}),E)E.style.display="none";k(B,A)}).catch((b)=>{if(E)E.style.display="none";G.innerHTML=`<p class="text-center text-red-500">Error: ${b.message}</p>`});function k(b,B){if(b.length===0){G.innerHTML=`<p style="text-align:center; color:var(--color-fallback-text); padding: 40px 0;">Tidak ditemukan artikel untuk "${B}"</p>`;return}G.innerHTML=`<p class="text-muted">ditemukan ${b.length} judul artikel...</p>`;let z=document.createElement("div");z.className="search-grid";let H=(j)=>{if(!j)return"";let J=B.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),K=new RegExp(`(${J})`,"gi");return j.replace(K,"<mark>$1</mark>")};b.forEach((j)=>{let J=j.filename?j.filename.replace(".html",""):"#",K=`/${j.catSlug}/${J}`,M=j.dateISO?new Date(j.dateISO).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"}):"",F=document.createElement("div");F.className="result-card",F.style.cssText="display:flex; flex-direction:column; border-radius:8px; overflow:hidden; height:100%;",F.innerHTML=`
            <a href="${K}" style="text-decoration:none; color:inherit; display:flex; flex-direction:column; height:100%;">
            <img src="${j.imageUrl}" alt="${j.title}" loading="lazy" onerror="this.src='/thumbnail.webp'">
            <div class="card-content">
            <span style="font-size: 10px; color: var(--color-primary); font-weight: bold; text-transform: uppercase;">${j.category}</span>
            <h3 class="card-title">${H(j.title)}</h3>
            <p class="card-desc" style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
            ${H(j.description)}
            </p>
            <div style="margin-top: auto; padding-top: 10px; display: flex; justify-content: space-between; align-items: center; font-size: 10px; color: var(--color-fallback-text);">
            <span>${M}</span>
            </div>
            </div>
            </a>
            `,z.appendChild(F)}),G.appendChild(z)}});
