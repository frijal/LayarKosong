var _=JSON.parse(localStorage.getItem("visitedLinks")||"[]"),W={},L=["linear-gradient(90deg, #004d40, #26a69a)","linear-gradient(90deg, #00796b, #009688)","linear-gradient(90deg, #00897b, #01579b)","linear-gradient(90deg, #009688, #4db6ac)","linear-gradient(90deg, #00acc1, #26c6da)","linear-gradient(90deg, #0288d1, #03a9f4)","linear-gradient(90deg, #0d47a1, #00bcd4)","linear-gradient(90deg, #0d47a1, #1976d2)","linear-gradient(90deg, #1565c0, #64b5f6)","linear-gradient(90deg, #1976d2, #2196f3)","linear-gradient(90deg, #1a237e, #3949ab)","linear-gradient(90deg, #1b5e20, #4caf50)","linear-gradient(90deg, #212121, #616161)","linear-gradient(90deg, #212121, #455a64)","linear-gradient(90deg, #2196f3, #00bcd4)","linear-gradient(90deg, #2e7d32, #8bc34a)","linear-gradient(90deg, #2e7d32, #4caf50)","linear-gradient(90deg, #33691e, #8bc34a)","linear-gradient(90deg, #37474f, #b0bec5)","linear-gradient(90deg, #388e3c, #4caf50)","linear-gradient(90deg, #3e2723, #a1887f)","linear-gradient(90deg, #3e2723, #ffc107)","linear-gradient(90deg, #607d8b, #9e9e9e)","linear-gradient(90deg, #6d4c41, #ffb300)","linear-gradient(90deg, #b71c1c, #ff7043)","linear-gradient(90deg, #cddc39, #8bc34a)","linear-gradient(90deg, #d32f2f, #f44336)","linear-gradient(90deg, #d84315, #ffca28)","linear-gradient(90deg, #e65100, #ffab00)","linear-gradient(90deg, #f44336, #ff9800)","linear-gradient(90deg, #f57c00, #ff9800)","linear-gradient(90deg, #fbc02d, #ffeb3b)"];function w(z){for(let F=z.length-1;F>0;F--){let G=Math.floor(Math.random()*(F+1));[z[F],z[G]]=[z[G],z[F]]}return z}function C(z){let F=new Date(z);if(isNaN(F))return"";let G=String(F.getDate()).padStart(2,"0"),J=String(F.getMonth()+1).padStart(2,"0"),Q=String(F.getFullYear()).slice(-2);return`${G}.${J}.${Q}`}function I(z,F,G=""){let J=document.getElementById("totalCount");if(!J)return;if(G){J.innerHTML=`Menemukan <strong>${z}</strong> artikel dari pencarian "${G}"`;return}let Q=z-F;J.innerHTML=`
  <span class="total-stat">Total: <strong>${z}</strong></span>
  <span class="separator">|</span>
  <span class="read-stat">Sudah Dibaca: <strong>${F}</strong> \uD83D\uDC4D</span>
  <span class="separator">|</span>
  <span class="unread-stat">Belum Dibaca: <strong>${Q}</strong> \uD83D\uDCDA</span>
  `}function V(z,F){let G=F.toLowerCase().replace(/\s+/g,"-"),J=z.replace(".html","");return`/${G}/${J}`}async function v(){try{let F=await(await fetch("artikel.json")).json(),G=document.getElementById("toc");G.innerHTML="",W={},Object.keys(F).forEach((K)=>{W[K]=F[K].map((N)=>({title:N[0],file:N[1],image:N[2],lastmod:N[3],description:N[4],category:K})).sort((N,P)=>new Date(P.lastmod)-new Date(N.lastmod))});let J=Object.values(W).reduce((K,N)=>K+N.length,0);I(J,_.length);let Q=w([...L]),R=document.getElementById("category-tooltip");Object.keys(W).sort((K,N)=>new Date(W[N][0].lastmod)-new Date(W[K][0].lastmod)).forEach((K,N)=>{let P=document.createElement("div");P.className="category";let $=Q[N%Q.length];P.style.setProperty("--category-color",$),P.innerHTML=`
      <div class="category-content">
      <div class="category-header">
      ${K} <span class="badge">${W[K].length}</span>
      </div>
      <div class="toc-list" style="display: none;"></div>
      </div>
      `;let q=P.querySelector(".toc-list");W[K].forEach((X)=>{let E=document.createElement("div");E.className="toc-item",E.dataset.text=X.title.toLowerCase();let H=document.createElement("div");H.className="toc-title";let Z=document.createElement("a");Z.href=V(X.file,X.category),Z.textContent=X.title;let j=document.createElement("span");if(_.includes(X.file))j.className="label-visited",j.textContent="sudah dibaca \uD83D\uDC4D",Z.classList.add("visited");else j.className="label-new",j.textContent="\uD83D\uDCDA belum dibaca";let B=document.createElement("span");B.className="toc-date",B.textContent=`[${C(X.lastmod)}]`,Z.addEventListener("click",()=>{if(!_.includes(X.file))_.push(X.file),localStorage.setItem("visitedLinks",JSON.stringify(_)),I(J,_.length)});let h=X.description||"Tidak ada deskripsi.";Z.addEventListener("mouseenter",()=>{if(R)R.innerHTML=h,R.style.display="block"}),Z.addEventListener("mousemove",(O)=>{if(R)R.style.left=O.clientX+15+"px",R.style.top=O.clientY+15+"px"}),Z.addEventListener("mouseleave",()=>{if(R)R.style.display="none"}),H.appendChild(Z),H.appendChild(j),H.appendChild(B),E.appendChild(H),q.appendChild(E)}),P.querySelector(".category-header").addEventListener("click",()=>{q.style.display=q.style.display==="block"?"none":"block",A()}),G.appendChild(P)});let Y=document.getElementById("marquee-content");if(Y){let K=Object.values(W).flat(),P=w([...K]).map(($)=>{let q=($.description||"Tidak ada deskripsi.").replace(/"/g,"&quot;");return`<a href="${V($.file,$.category)}" data-description="${q}">${$.title}</a>`}).join(" &bull; ");Y.innerHTML=P}}catch(z){console.error("Gagal load artikel.json",z)}}var M=document.getElementById("search"),b=document.getElementById("clearSearch");M.addEventListener("input",function(){let z=this.value.toLowerCase();b.style.display=this.value?"block":"none";let F=0,G=Object.values(W).flat().length;if(document.querySelectorAll(".category").forEach((J)=>{let Q=!1;J.querySelectorAll(".toc-item").forEach((Y)=>{let K=Y.dataset.text,N=Y.querySelector("a");if(z&&K.includes(z)){Y.style.display="flex",Q=!0,F++;let P=new RegExp(`(${z})`,"gi");N.innerHTML=K.replace(P,'<span class="highlight">$1</span>')}else if(!z)Y.style.display="flex",N.textContent=K,Q=!0;else Y.style.display="none"}),J.style.display=Q?"block":"none";let R=J.querySelector(".toc-list");if(R)R.style.display=z&&Q?"block":"none"}),z)I(F,_.length,z);else I(G,_.length);A()});b.addEventListener("click",()=>{M.value="",M.dispatchEvent(new Event("input"))});var U=!1,x=document.getElementById("tocToggle");function A(){let z=Array.from(document.querySelectorAll(".toc-list"));if(z.length===0)return;U=z.every((G)=>G.style.display==="none"),x.textContent=U?"Buka Semua":"Tutup Semua"}x.addEventListener("click",()=>{U=!U,document.querySelectorAll(".toc-list").forEach((z)=>{z.style.display=U?"none":"block"}),A()});function D(){let z=document.getElementById("darkSwitch"),F=localStorage.getItem("darkMode");function G(J){if(J)document.body.classList.add("dark-mode");else document.body.classList.remove("dark-mode");if(z)z.checked=J}if(F!==null)G(F==="true");else G(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches);if(z)z.addEventListener("change",()=>{localStorage.setItem("darkMode",z.checked),G(z.checked)})}document.addEventListener("DOMContentLoaded",()=>{v().then(()=>{D(),A()})});
