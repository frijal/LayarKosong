(function(){function E(){return window.innerWidth<=768||"ontouchstart"in window||navigator.maxTouchPoints>0}function L(j){return j?j.replace(/\.html$/,""):""}function H(){let Q=window.location.pathname.split("/").filter(Boolean).pop();if(!Q||Q==="artikel")return"";return Q.endsWith(".html")?Q:`${Q}.html`}function Z(j,Q){for(let[J,K]of Object.entries(Q))if(K.some((V)=>V[1]===j))return`/${J.toLowerCase().replace(/\s+/g,"-")}/${j.replace(".html","")}/`;return`/artikel/${L(j)}`}function O(j,Q){for(let[J,K]of Object.entries(Q))if(K.some((V)=>V[1]===j))return{name:J,slug:J.toLowerCase().replace(/\s+/g,"-"),list:K};return null}function P(){let j=document.getElementById("related-marquee-container");if(!j)return;let Q=getComputedStyle(document.body).backgroundColor,[J,K,V]=(Q.match(/\d+/g)||[0,0,0]).map(Number),X=0.299*J+0.587*K+0.114*V;j.classList.toggle("theme-light",X>128)}function w(){let j=document.getElementById("related-marquee-container");if(!j)return;j.addEventListener("click",(Q)=>{let J=Q.target.closest("a");if(!J)return;let K=J.dataset.articleId;if(!K)return;let V=JSON.parse(localStorage.getItem("read_marquee_articles")||"[]");if(!V.includes(K))V.push(K),localStorage.setItem("read_marquee_articles",JSON.stringify(V))})}function R(){let j=document.getElementById("progress");if(!j)return;let Q=()=>{let{documentElement:J,body:K}=document,V=J.scrollTop||K.scrollTop,X=J.scrollHeight||K.scrollHeight,W=J.clientHeight,Y=X-W,$=Y>0?V/Y*100:0;j.style.width=$+"%"};document.addEventListener("scroll",Q,{passive:!0}),Q()}function S(j,Q){let J=document.getElementById("related-marquee-container");if(!J)return;try{let K=O(Q,j);if(!K)return;let V=K.list.filter((_)=>_[1]!==Q),X=JSON.parse(localStorage.getItem("read_marquee_articles")||"[]"),W=V.filter((_)=>!X.includes(_[1]));if(W.length===0){J.innerHTML='<p class="marquee-message">Semua artikel terkait sudah dibaca. \uD83D\uDE0A</p>';return}W.sort(()=>0.5-Math.random());let Y=" • ",$=E(),z=W.map(([_,G,,,M])=>{return`<a href="${Z(G,j)}" data-article-id="${G}" title="${$?_:M||_}">${_}</a>${Y}`}).join("");J.innerHTML=`<div class="marquee-content">${z.repeat(10)}</div>`;let B=J.querySelector(".marquee-content");if(B){let _=B.offsetWidth,G=$?40:75;B.style.animationDuration=`${_/2/G}s`}w()}catch(K){console.error("Marquee Error:",K)}}function U(j){let Q=document.querySelector(".search-floating-container"),J=document.getElementById("floatingSearchInput"),K=Q?.querySelector(".clear-button"),V=Q?.querySelector(".floating-results-container");if(!Q||!J||!K||!V)return;let X=()=>{let W=J.value.trim();if(W.length>0)window.location.href=`/search/?q=${encodeURIComponent(W)}`};J.addEventListener("input",()=>{let W=J.value.trim();K.style.display=W.length?"block":"none";let Y=W.toLowerCase();if(Y.length<3){V.style.display="none";return}let $=[];for(let z in j)for(let B of j[z])if((B[0]+" "+(B[4]||"")).toLowerCase().includes(Y))$.push(B);if($.length>0){let B=$.slice(0,5).map((_)=>`
        <a href="${Z(_[1],j)}">
        <strong>${_[0]}</strong>
        <small>${_[4]?_[4].substring(0,60)+"...":"Lihat artikel"}</small>
        </a>
        `).join("");V.innerHTML=B,V.style.display="block"}else V.innerHTML='<div class="no-results">❌ Tidak ditemukan</div>',V.style.display="block"}),J.addEventListener("keydown",(W)=>{if(W.key==="Enter")W.preventDefault(),X()}),K.addEventListener("click",()=>{J.value="",V.style.display="none",K.style.display="none"}),document.addEventListener("click",(W)=>{if(!Q.contains(W.target))V.style.display="none"})}function y(j,Q){let J=O(Q,j);if(!J)return;let K=J.list.findIndex(($)=>$[1]===Q),V=J.list.length,X=(K-1+V)%V,W=(K+1)%V,Y=document.getElementById("dynamic-nav-container")||document.createElement("div");if(Y.id="dynamic-nav-container",Y.className="floating-nav",Y.innerHTML=`
    <div class="nav-left">
    <a href="/${J.slug}/" class="category-link visible">${J.name}</a>
    </div>
    <div class="nav-right">
    <a href="/" title="Home" class="btn-emoji">\uD83C\uDFE0</a>
    <a href="/sitemap/" title="Daftar Isi" class="btn-emoji">\uD83D\uDCC4</a>
    <a href="/feed/" title="RSS Feed" class="btn-emoji">\uD83D\uDCE1</a>
    ${V>1?`
      <a href="${Z(J.list[W][1],j)}" title="${J.list[W][0]}" class="btn-emoji">⏩</a>
      <a href="${Z(J.list[X][1],j)}" title="${J.list[X][0]}" class="btn-emoji">⏪</a>
      `:""}
      </div>`,!Y.parentElement)document.body.appendChild(Y)}function q(){let j=document.getElementById("internal-nav");if(!j)return;let Q=Array.from(document.querySelectorAll("h1, h2, h3, h4")).filter((K)=>K.innerText.trim().length>0&&!K.closest(".floating-nav")&&!j.contains(K)&&!K.closest("#layar-kosong-header"));if(Q.length===0){j.style.display="none";return}let J='<ul class="nav-list">';Q.forEach((K,V)=>{if(!K.id)K.id=K.innerText.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"")||`section-${V}`;J+=`<li class="nav-item nav-${K.tagName.toLowerCase()}"><a href="#${K.id}" class="nav-link">${K.innerText.trim()}</a></li>`}),j.innerHTML=J+"</ul>"}function A(j,Q){let J=document.getElementById("related-articles-grid");if(!J)return;let K=O(Q,j);if(!K){J.style.display="none";return}let V=K.list.filter((X)=>X[1]!==Q).sort(()=>0.5-Math.random()).slice(0,6);J.innerHTML=V.map(([X,W,Y])=>`
    <div class="rel-card-mini">
    <a href="${Z(W,j)}">
    <div class="rel-img-mini"><img src="${Y||"/thumbnail.webp"}" alt="${X}" loading="lazy" onerror="this.src='/thumbnail.webp'"></div>
    <div class="rel-info-mini"><h4>${X}</h4></div>
    </a>
    </div>
    `).join("")}async function k(){try{q(),R();let j=null,Q=sessionStorage.getItem("artikel_data_cache");if(Q)j=JSON.parse(Q);else{let K=await fetch("/artikel.json");if(!K.ok)throw Error("Gagal memuat artikel.json");j=await K.json(),sessionStorage.setItem("artikel_data_cache",JSON.stringify(j))}let J=H();S(j,J),A(j,J),U(j),y(j,J),P(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",P)}catch(j){console.error("Layar Kosong Init Error:",j)}}if(document.readyState==="loading")document.addEventListener("DOMContentLoaded",k);else k()})();
